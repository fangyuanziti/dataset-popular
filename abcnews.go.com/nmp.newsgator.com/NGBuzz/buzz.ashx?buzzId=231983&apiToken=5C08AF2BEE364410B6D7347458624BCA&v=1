try{var buzzTemplate_231983="{if LoadScript(\"http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js\", \"typeof jQuery != 'undefined' && (jQuery.fn.jquery == '1.2.6' || jQuery.fn.innerWidth)\")\n}\n\n<div class=\"ng_buzzContainer\" id=\"ngWidgetBox_${BuzzId}\" align=\"left\">\n\t<div id=\"outerContainer\">\n\t\t<div id=\"localHeader\">\n\t\t\t<div id=\"headerBranding\" style=\"float: left; width: 410px; visibility: hidden;\">\n\t\t\t\t<a id=\"headerLogoLink\" target=\"_blank\"><img id=\"headerLogo\" style=\"float: left;\" border=\"0\" /></a>\n\t\t\t\t<div id=\"marketName\" style=\"height: 33px; float: left;\">L.A. &#8211; Orange &#8211; Inland Empire</div>\n\t\t\t</div>\n\t\t\t<div id=\"locationChange\" style=\"float: right; width: 220px; text-align: right;\">\n\t\t\t\t<select id=\"locationDDL\" style=\"width: 200px; visibility: hidden;\">\n\t\t\t\t\t<option>-- Change Location --</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"localMenuContainer\">\n\t\t<ul id=\"localMenu\" class=\"localMenu\"></ul>\n\t\t</div>\n\t\t<div id=\"tabContentContainer\" style=\"display: none;\">\n\t\t</div>\n\t\t<div id=\"loadingContainer\">\n\t\t\tLoading...\n\t\t</div>\n\t</div>\n</div>\n\n<textarea id=\"localStoryTemplate\" style=\"display: none;\">\n{cdata}\n\t<div style=\"float: left; width: 200px;\">\n\t{var omnitureId = \"local_\" + Data.callLetters + \"_t\" + Data.tabPosition + \"_\" + Data.tabName}\n\n\t{var firstPost = Data.posts[0]}\n\t{if (firstPost.MediaRSS != null && firstPost.MediaRSS.Thumbnails != null && firstPost.MediaRSS.Thumbnails.length > 0)}\n\t\t{var selectedThumbnail = null}\n\t\t{for thumbnail in firstPost.MediaRSS.Thumbnails}\n\t\t\t{eval}\n\t\t\tvar maxWidth = 186;\n\t\t\t//attempt a smart find of thumbnails to get the largest that will fit\n\t\t\tif (thumbnail.Width != undefined && thumbnail.Width != null && thumbnail.Width <= maxWidth)\n\t\t\t{\n\t\t\t\t//ignore abc_default_image\n\t\t\t\tif (thumbnail.Url.toLowerCase().indexOf(\"abc_default_image\") == -1)\n\t\t\t\t{\n\t\t\t\t\tif (selectedThumbnail == null)\n\t\t\t\t\t{\n\t\t\t\t\t\tselectedThumbnail = thumbnail;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif ((maxWidth - selectedThumbnail.Width) > (maxWidth - thumbnail.Width))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tselectedThumbnail = thumbnail;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t{/eval}\n\n\t\t{/for}\n\t\t{if (selectedThumbnail != null)}\n\t\t\t<div style=\"max-width: 186px; max-height: 200px; overflow: hidden;\">\n\t\t\t\t<a href=\"${firstPost.HtmlUrl}\" name=\"lpos=widget[${omnitureId}]&lid=link[FeatureImage]\" target=\"_blank\"><img src=\"${selectedThumbnail.Url}\" style=\"max-width: 186px; width: expression(this.width > 186 ? 186: true);\" border=\"0\" /></a>\n\t\t\t</div>\n\t\t{/if}\n\t{else if (firstPost.EnclosureUrl && firstPost.EnclosureType && firstPost.EnclosureType.toLowerCase().indexOf(\"image\") != -1)}\n\t\t{if (firstPost.EnclosureUrl != \"\")}\n\t\t<div style=\"max-width: 186px; max-height: 200px; overflow: hidden;\">\n\t\t\t<a href=\"${firstPost.HtmlUrl}\" name=\"lpos=widget[${omnitureId}]&lid=link[FeatureImage]\" target=\"_blank\"><img src=\"${firstPost.EnclosureUrl}\" style=\"max-width: 186px; width: expression(this.width > 186 ? 186: true);\" border=\"0\" /></a>\n\t\t</div>\n\t\t{/if}\n\t{/if}\n\n\t<div class=\"topHeadline\">\n\t\t<a href=\"${firstPost.HtmlUrl}\" name=\"lpos=widget[${omnitureId}]&lid=link[FeatureHeadline]\" target=\"_blank\">${firstPost.Title}</a><br />\n\t</div>\n\t${firstPost.Description|stripHtml|excerpt:200}\n\t</div>\n\t<div style=\"float: left; width: 400px; margin-left: 25px;\">\n\t\t<span class=\"headerText\">${Data.headerText}</span><br />\n\t\t<ul>\n\t\t\t{var index = 0}\n\t\t\t{for post in Data.posts}\n\t\t\t\t{if (index > 0 && index < 6)}\n\t\t\t\t<li><a href=\"${post.HtmlUrl}\" name=\"lpos=widget[${omnitureId}]&lid=link[Headline]\" target=\"_blank \"onclick=\"${AttentionClickJS(post)}\">${post.Title}</a></li>\n\t\t\t\t{/if}\n\t\t\t\t{eval}\n\t\t\t\t\tindex++;\n\t\t\t\t{/eval}\n\t\t\t{/for}\n\t\t</ul>\n\t</div>\n\t<br clear=\"both\" />\n{/cdata}\n</textarea>\n\n\n<textarea id=\"localWeatherTemplate\" style=\"display: none;\">\n{cdata}\n\t{var omnitureId = \"local_\" + Data.callLetters + \"_t2_weather\"}\n\t<div style=\"float: left;\">\n\t\t{if (Data.image != null)}\n\t\t\t<div style=\"max-width: 335px; max-height: 300px; overflow: hidden;\">\n\t\t\t\t<a href=\"${Data.image.url}\" name=\"lpos=widget[${omnitureId}]&lid=link[FeatureImage]\" target=\"_blank\"><img src=\"${Data.image.src}\" width=\"${Data.image.width}\" height=\"${Data.image.height}\" border=\"0\" style=\"border: solid 1px #CCCCCC;\" /></a><br />\n\t\t\t\t<b>${Data.image.description}</b>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\t<div style=\"float: left; margin-left: 25px; width: 250px;\">\n\t\t\n\t\t{if Data.altImage != null}\n\t\t\t<img src=\"${Data.altImage.src}\" height=\"${Data.altImage.height}\" width=\"${Data.altImage.width}\" alt=\"${Data.altImage.altText|html}\" style=\"margin-bottom: 7px; border: solid 1px #CCCCCC;\" />\n\t\t{/if}\n\t\t<span class=\"headerText\">${Data.headerText}</span><br />\n\t\t<ul>\n\t\t{for link in Data.links}\n\t\t\t<li><a href=\"${link.url}\" name=\"lpos=widget[${omnitureId}]&lid=link[Headline]\" target=\"_blank\">${link.title}</a></li>\n\t\t{/for}\n\t\t</ul>\n\t</div>\n\t<br clear=\"both\" />\n{/cdata}\n</textarea>\n\n\n{eval}\nAddPostRenderCallback(function(){\n\tNGLocalBuzz.buzzObj = BuzzObj;\n\tNGLocalBuzz.buzzId = BuzzId;\n\tNGLocalBuzz.apiToken = ApiToken;\n\tNGLocalBuzz.orgCode = OrgCode;\n\tNGLocalBuzz.appUrl = BuzzAppUrl;\n\tNGLocalBuzz.buzzNamePrefix = \"_ABC Local News - \";\n\tNGLocalBuzz.masterName = \"_Master\";\n\t\n\tif (BuzzAppUrl.toLowerCase().indexOf(\"hosted.newsgator\") != -1)\n\t{\n\t\tNGLocalBuzz.loadFromCookieEnabled = false;\n\t}\n\tNGLocalBuzz.enableDebugOutput = true;\n\tNGLocalBuzz.initialize();\n\n});\n{/eval}\n\n{/if} \t\t";}catch(e){}

try{var buzzStyles_231983="/*\n[1. Reset and Global]\n*/\n\n#ngWidgetBox_231983 div,#ngWidgetBox_231983 dl,#ngWidgetBox_231983 dt,#ngWidgetBox_231983 dd,#ngWidgetBox_231983 ol,,#ngWidgetBox_231983 h1,#ngWidgetBox_231983 h2,#ngWidgetBox_231983 h3,#ngWidgetBox_231983 h4,#ngWidgetBox_231983 h5,#ngWidgetBox_231983 h6,#ngWidgetBox_231983 pre,#ngWidgetBox_231983 code,#ngWidgetBox_231983 form,#ngWidgetBox_231983 fieldset,#ngWidgetBox_231983 legend,#ngWidgetBox_231983 input,#ngWidgetBox_231983 textarea,#ngWidgetBox_231983 p,#ngWidgetBox_231983 blockquote,\n#ngWidgetBox_231983 span, #ngWidgetBox_231983 applet, #ngWidgetBox_231983 object, #ngWidgetBox_231983 iframe,\n#ngWidgetBox_231983 abbr, #ngWidgetBox_231983 acronym, #ngWidgetBox_231983 address, #ngWidgetBox_231983 big, #ngWidgetBox_231983 cite, #ngWidgetBox_231983 code,\n#ngWidgetBox_231983 del, #ngWidgetBox_231983 dfn, #ngWidgetBox_231983 em, #ngWidgetBox_231983 font, #ngWidgetBox_231983 img, #ngWidgetBox_231983 ins, #ngWidgetBox_231983 kbd, #ngWidgetBox_231983 q, #ngWidgetBox_231983 s, #ngWidgetBox_231983 samp,\n#ngWidgetBox_231983 small, #ngWidgetBox_231983 strike, #ngWidgetBox_231983 strong, #ngWidgetBox_231983 sub, #ngWidgetBox_231983 sup, #ngWidgetBox_231983 tt, #ngWidgetBox_231983 var, #ngWidgetBox_231983 form, #ngWidgetBox_231983 label, \n#ngWidgetBox_231983 table, #ngWidgetBox_231983 caption, #ngWidgetBox_231983 tbody, #ngWidgetBox_231983 tfoot, #ngWidgetBox_231983 thead, #ngWidgetBox_231983 tr, #ngWidgetBox_231983 th,#ngWidgetBox_231983 td{\n    margin:0;\n    padding:0;\n    line-height:1.1em;\n    margin: 0;\n    padding: 0;\n    border: 0;\n    outline: 0;\n    font-variant: normal;\n    font-weight: normal;\n    font-style: normal;\n    font-size: 100%;\n    vertical-align: baseline;\n    background-color:transparent;\n    background-image:none;\n    color:#000;\n    text-align:left;\n    color:#222;\n    font-family:\"Lucida Grande\",Geneva,arial,sans-serif;\n}\n#ngWidgetBox_231983 table{border-collapse:collapse;border-spacing:0;}\n#ngWidgetBox_231983 fieldset,#ngWidgetBox_231983 fieldset img{border:0;}\n#ngWidgetBox_231983 address,#ngWidgetBox_231983 caption,#ngWidgetBox_231983 cite,#ngWidgetBox_231983 code,#ngWidgetBox_231983 dfn,#ngWidgetBox_231983 em,#ngWidgetBox_231983 strong,#ngWidgetBox_231983 th,#ngWidgetBox_231983 var{font-style:normal;font-weight:normal;}\n\n\n#ngWidgetBox_231983 caption{text-align:left;font-weight: normal;}\n#ngWidgetBox_231983 h1,#ngWidgetBox_231983 h2,#ngWidgetBox_231983 h3,#ngWidgetBox_231983 h4,#ngWidgetBox_231983 h5,#ngWidgetBox_231983 h6{font-size:100%;font-weight:normal;}\n#ngWidgetBox_231983 blockquote:before, #ngWidgetBox_231983 blockquote:after,ngWidgetBox_231983 q:before,#ngWidgetBox_231983 q:after{content:'';}\n#ngWidgetBox_231983 blockquote, #ngWidgetBox_231983 q {quotes: \"\" \"\";}\n#ngWidgetBox_231983 abbr,#ngWidgetBox_231983 acronym {border:0;font-variant:normal;}\n#ngWidgetBox_231983 sup {vertical-align:text-top;}\n#ngWidgetBox_231983 sub {vertical-align:text-bottom;}\n#ngWidgetBox_231983 input,#ngWidgetBox_231983 textarea,#ngWidgetBox_231983 select{font-family:inherit;font-size:inherit;font-weight:inherit;}\n#ngWidgetBox_231983 input,#ngWidgetBox_231983 textarea,#ngWidgetBox_231983 select{*font-size:100%;}\n#ngWidgetBox_231983 legend{color:#000;}\n\n/* Constrain floats & clears */\n#ngWidgetBox_231983{\n    overflow:hidden;\n    zoom:1;\n}\n\n#ngWidgetBox_231983 #outerContainer\n{\n\tfont-family: Arial, Helvetica;\n\tfont-size: 12px;\n\twidth: 658px;\n\tmargin-bottom: 10px;\n\t/*height: 350px;\n\tborder: solid 1px #FF0000;\n\t*/\n\toverflow: hidden;\n}\n\n#ngWidgetBox_231983 #localHeader\n{\n\t/*border: solid 1px #FF0000;\n\t*/\n\theight: 33px;\n\tmargin-top: 8px;\n\tmargin-bottom: 14px;\n}\n\n#ngWidgetBox_231983 #marketName\n{\n\tpadding-top: 2px;\n\t*padding-top:3px;\n\tpadding-left: 5px;\n\tfont-size: 21px;\n\tfont-family:georgia, 'times new roman', serif;\n\tfont-weight: normal;\n}\n\n#ngWidgetBox_231983 .localMenuContainer\n{\n\tborder-bottom: solid 1px #d8d8d8;\n\tposition: relative; \n\theight: 35px; \n\tmargin-bottom: 13px;\n}\n#ngWidgetBox_231983 #locationChange {position:relative;\ntop:5px;\n*top:4px;\nleft:-20px;\n}\n\n#ngWidgetBox_231983 .localMenu\n{\n\theight: 34px;\n\tlist-style-type: none;\n\tmargin-top: 0px;\n\tmargin-left: 0px;\n\tpadding-left: 0px;\n\tposition: absolute;\n}\n\n#ngWidgetBox_231983 .localMenu li\n{\n\tcolor: #369;\n\tfont-size: 12px;\n\tfloat: left;\n\tbackground: url('http://abcnews.go.com/assets/images/iphone/gradientBkg-ccc.gif') repeat-x scroll 0 -10px #FFFFFF;\n\theight: 34px !important;\n\theight: 32px;\n\tcursor: pointer;\n\tborder-right: 1px solid #bcbcbc;\n\tfont-family: georgia, 'times new roman', serif;\n}\n\n#ngWidgetBox_231983 .localMenu li div\n{\n\tmargin-left: 5px;\n\tmargin-right: 5px;\n\tmargin-top: 10px;\n\ttext-align: center;\n\tmin-width: 100px;\n\tfont-family: georgia, 'times new roman', serif;\n}\n\t#ngWidgetBox_231983 .localMenu li:hover {background:#ddd;}\n\t\t#ngWidgetBox_231983 .localMenu li:hover div {text-decoration:underline;}\n\t\t\n\t#ngWidgetBox_231983 .localMenu li.selected:hover {background:#fff !important;}\n\t\t#ngWidgetBox_231983 .localMenu li.selected:hover div {text-decoration:none !important;}\n\n#ngWidgetBox_231983 .localMenu li.selected div\n{\n\tmargin-top: 9px;\n\tmargin-left: 5px;\n\tmargin-right: 5px;\n\tcolor:#333;\n}\n\n#ngWidgetBox_231983 #outerContainer #tabContentContainer\n{\n\t/*border: solid 1px #0000ff;\n\t*/\n}\n\n\n#ngWidgetBox_231983 .localMenu li.selected\n{\n\tborder-left: solid 1px #d8d8d8;\n\tborder-right: solid 1px #d8d8d8;\n\tborder-top: solid 1px #d8d8d8;\n\tborder-bottom: solid 1px #FFFFFF;\n\tbackground-color: #FFFFFF;\n\tbackground-image: none;\n\theight: 34px !important;\n\theight: 35px;\n\tcursor: default;\n}\n\n#ngWidgetBox_231983 #tabContentContainer\n{\n\tline-height: 15px;\n}\n\n#ngWidgetBox_231983 #tabContentContainer  .topHeadline\n{\n\tfont-size: 14px;\n\tcolor: #336699;\n\tline-height: 18px;\n\tmargin-top: 3px;\n\tmargin-bottom: 2px;\n\tfont-family:georgia, 'times new roman', serif;\n}\n\n#ngWidgetBox_231983 #tabContentContainer a\n{\n\ttext-decoration: none;\n\tcolor: #336699;\n}\n\t#ngWidgetBox_231983 #tabContentContainer a:hover {text-decoration:underline;}\n\n#ngWidgetBox_231983 #tabContentContainer .headerText\n{\n\tdisplay:none;\n}\n\n#ngWidgetBox_231983 #tabContentContainer .localContent > div:first-child {\n\tpadding-left:10px;\n\tmargin-right: 5px;\t\n}\n\n\n#ngWidgetBox_231983 #tabContentContainer ul\n{\n\tlist-style-type: none;\n\tpadding: 0px;\n\tmargin: 0px;\n\tmargin-top:-10px !important;\n\tmargin-left: 0px;\n\tpadding-left: 0px;\n\tcolor: #336699;\n\tline-height: 20px;\n\tfont-size:13px;\n\tfont-family: georgia, 'times new roman', serif;\n}\n\n#ngWidgetBox_231983 #tabContentContainer ul li\n{\n\tline-height: 15px;\n\tmargin-bottom: 5px;\n\tpadding-left: 0px;\n\tpadding-bottom: 5px;\n\tborder-bottom: 1px dashed #bcbcbc;\n}\n\n#ngWidgetBox_231983 #loadingContainer\n{\n\ttext-align: center;\n}";}catch(e){}



(function(){
if(!window.ng || !window.ng.buzz){
document.write('<script language="javascript" src="http://nmp.newsgator.com/NGBuzz/4793/load.ashx/buzz"></script>');
}
var targetId = "buzzTgt_231983_" + Math.floor(Math.random() * 10000000);
document.write('<div style="display:inline" id="' + targetId + '" class="ng_buzzAutoTarget"></div>');

var s = function(){
	try{
		if(typeof ng != "undefined" && typeof ng.buzz != "undefined" && ng.buzz.Buzzlet){
			var b = new ng.buzz.Buzzlet({scriptCtx:'window',orgCode:'ABCN',extraArgs:{v:'1'},buzzAppUrl:'http://nmp.newsgator.com/NGBuzz/',templateId:'buzzTemplate_231983',targetId:null,apiToken:'5C08AF2BEE364410B6D7347458624BCA',buzzTracking:{parentTrackingId:null,myTrackingId:null},buzzId:231983,analytics:{ngAcct:'UA-130916-2'},WidgetConfiguration:{configUrl:'http://nmp.newsgator.com/host/ABCN/misc/default_local.xml',FlintSaginawBayCity:'Mid-Michigan',RaleighDurhamFayetvlle:'Raleigh-Durham',SanFranciscoOakSanJose:'San Francisco',FresnoVisalia:'Fresno',SACRAMNTOSTKTONMODESTO:'Sacramento',AUSTIN:'Austin',NORFOLKPORTSMTHNEWPTNWS:'Norfolk',LINCOLNHASTINGSKRNY:'Lincoln',SIOUXCITY:'Sioux City, Iowa',DESMOINESAMES:'Des Moines',KEARNEY:'Kearney',elpasolascruces:'El Paso - Las Cruces',INDIANAPOLIS:'Indianapolis',BAKERSFIELD:'Bakersfield',DENVER:'Denver',SANDIEGO:'San Diego',CHARLOTTE:'Charlotte'},directUrl:'http://hosted.newsgator.com/',name:'_ABC Local News - _Master'});
			
			b._targetId = targetId;
			
			b.render();
		} else {
			setTimeout(function(){
				s();
			}, 50);
		}
	} catch(e){
		
	}
};
setTimeout(s, 1); 
})();var buzzScript_231983 = "var NGLocalBuzz_Class = function()\n{\n\tthis.buzzObj = null;\n\tthis.buzzId = null;\n\tthis.apiToken = null;\n\tthis.orgCode = null;\n\tthis.cookieName = \"ngZipCode\";\n\tthis.loadFromCookieEnabled = true;\n\tthis.zipCode = null;\n\tthis.appUrl = null;\n\tthis.buzzNamePrefix = \"\";\n\tthis.currentConfig = null;\n\tthis.currentCallLetters = \"\";\n\tthis.configCache = {};\n\tthis.otherLocations = [];\n\tthis.masterName = null;\n\tthis.proxyPath = \"Embed/jsonpproxy.aspx\";\n\tthis.enableDebugOutput = false;\n\n\t\n\tvar _this = this;\n\t\n\tvar NGBuzzAPI={ajaxUrl:_this.appUrl + '/gateway.ashx/ngdsr/',className:'NGBuzz.Classes.BuzzAPI,NGBuzz', isValidBuzz:function(_0,_1,cb,t){ng.dsr.bind(this.ajaxUrl,{C_:this.className,M_:'IsValidBuzz',buzzId:_0,apiToken:_1},cb,t);}, lookupDMA:function(_0,_1,_2,cb,t){ng.dsr.bind(this.ajaxUrl,{C_:this.className,M_:'LookupDMA',buzzId:_0,apiToken:_1,zipCode:_2},cb,t);}, findBuzzIDsByPrefix:function(_0,_1,_2,_3,cb,t){ng.dsr.bind(this.ajaxUrl,{C_:this.className,M_:'FindBuzzIDsByPrefix',buzzId:_0,apiToken:_1,orgCode:_2,prefix:_3},cb,t);}};\n\t\n\tthis.initialize = function()\n\t{\n\t\t//init ajaxurl\n\t\tNGBuzzAPI.ajaxUrl = _this.appUrl + \"/gateway.ashx/ngdsr/\";\n\n\t\tvar zipValue = null;\n\t\t//look for the cookie value\n\t\tvar cookieValue = _this.getCookie(_this.cookieName);\n\n\t\tif (_this.loadFromCookieEnabled == true && cookieValue)\n\t\t{\n\t\t\t\n\t\t\tzipValue = _this.formatZipCode(cookieValue);\n\t\t}\n\t\t\n\t\tif (zipValue && zipValue != \"00000\")\n\t\t{\n\t\t\t_this.debug(\"zip code found in cookie: \" + zipValue);\n\t\t\t_this.setZipCode(zipValue);\n\t\t\t_this.findDMAForZip(_this.zipCode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_this.debug(\"looking up zip code\");\n\t\t\t_this.lookupZipCode(function(data){\n\t\t\t\t_this.setZipCode(data);\n\t\t\t\t_this.findDMAForZip(_this.zipCode);\n\t\t\t});\n\t\t}\n\t\t\n\t\t_this.loadOtherLocations();\n\t};\n\t\n\tthis.setZipCode = function(value)\n\t{\n\t\t_this.zipCode = _this.formatZipCode(value);\n\t\t\n\t\t_this.setCookie(_this.cookieName, value);\n\t};\n\t\n\tthis.formatZipCode = function(value)\n\t{\n\t\tvar zip = new String(value);\n\t\tif (zip.length < 5)\n\t\t{\n\t\t\tfor (x = 0; x <= (5-zip.length); x++)\n\t\t\t{\n\t\t\t\tzip = \"0\" + zip;\t\n\t\t\t}\n\t\t}\n\t\treturn zip;\n\t};\n\t\n\tthis.lookupZipCodeTimedOut = false;\n\tthis.lookupZipCodeSucceeded = false;\n\tthis.lookupZipCode = function(callback)\n\t{\n\t\t\n\t\t_this.lookupZipCodeCallbackFunction = callback;\n\t\t\n\t\tvar scriptUrl = \"http://app.abcnews.go.com/app/ipzip?callback=\" + encodeURIComponent(\"NGLocalBuzz.lookupZipCodeCallback\");\n\t\t\n\t\t/*\n\t\t//handle events such as timeout\n\t\tvar errorHandler = function(XMLHttpRequest, textStatus, errorThrown){\n\t\t\t_this.debug(textStatus + \" - \" + errorThrown);\n\t\t\t_this.loadDMAConfiguration(\"unknown\");\n\t\t};\n\t\t*/\n\t\t\n\t\t//reset timedout flags\n\t\t_this.lookupZipCodeTimedOut = false;\n\t\t_this.lookupZipCodeSucceeded = false;\n\t\t\n\t\t//fire off a timed event to load default if lookup times out\n\t\tsetTimeout(function(){\n\t\t\tif (_this.lookupZipCodeSucceeded == true)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\t_this.lookupZipCodeTimedOut = true;\n\t\t\t\n\t\t\t//track how many ip-to-zip timeouts occur\n\t\t\t_this.buzzObj.logGenericEvent(\"custom1\");\n\t\t\t\n\t\t\t_this.debug(\"zip code lookup timed out, loading default\");\n\t\t\t_this.loadDMAConfiguration(\"unknown\");\n\t\t\t\n\t\t}, 6*1000);\n\n\t\t//note: cache=true and dataType=script\n\t\t$.ajax({url: scriptUrl, cache: true, dataType: \"script\", type: \"GET\", callback: null, data:null });\n\t};\n\t\n\tthis.lookupZipCodeCallbackFunction = null;\n\tthis.lookupZipCodeCallback = function(data)\n\t{\n\t\tif (_this.lookupZipCodeTimedOut == true)\n\t\t{\n\t\t\t//lookup timed out, do nothing\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (_this.lookupZipCodeCallbackFunction != null)\n\t\t{\n\t\t\t_this.lookupZipCodeSucceeded = true;\n\t\t\t\n\t\t\t_this.debug(\"zip code lookup succeeded: \" + data.zipCode);\n\t\t\t//data.zipCode = \"90001\";\n\t\t\t_this.lookupZipCodeCallbackFunction(data.zipCode);\n\t\t}\n\t}\n\t\n\tthis.findDMAForZip = function(zipCode)\n\t{\n\t\tvar zip = parseInt(_this.zipCode, 10);\n\t\t\n\t\tif (zip == null || isNaN(zip)) \n\t\t{ \n\t\t\t_this.debug(\"zip code is null or NaN\");\n\t\t\treturn;\n\t\t}\n\t\t\t\t\n\t\tvar lookupCallback = function(a, res, c)\n\t\t{\n\t\t\tif (res.error != \"\")\n\t\t\t{\n\t\t\t\t//error handling\n\t\t\t\t_this.debug(res.error);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (res.result == undefined)\n\t\t\t{\n\t\t\t\t_this.debug(\"possibly invalid zip code: \" + zipCode + \". No DMAs found\");\n\t\t\t\t_this.debug(\"loading default\");\n\t\t\t\t_this.loadDMAConfiguration(\"unknown\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdmaInfo = res.result;\n\t\t\t\t\n\t\t\t\t//added by jennyb@newsgator.com august 2010\n\t\t\t\t//certain zip codes need to be associated with Kearney, Nebraska, instead of Lincoln.\n\t\t\t\tif (zip >= '66930' && zip <= '69217')\n\t\t\t\t{\n\t\t\t\t\tif (! (zip in oc(['68623','68624','68626','68627','68632','68635','68640','68651','68652','68655','68658','68660','68662','68720','68726','68756','68761','68764','68769','68773','69157'])))\n\t\t\t\t\t{\n\t\t\t\t\t\tif ((zip >= '66930' && zip <= '66970') || (zip >= '67621' && zip <= '67664') || (zip == '68371') || (zip == '68452') || (zip >= '68622' && zip <= '68665') || (zip >= '68711' && zip <= '68780') || (zip >= '68801' && zip <= '68883') || (zip == '68901') || (zip == '68902') || (zip >= '68920' && zip <= '68982') || (zip == '69001') || (zip >= '69020' && zip <= '69046') || (zip >= '69120' && zip <= '69171') || (zip >= '69210' && zip <= '69217'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdmaInfo.DMAName = 'Kearney';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t_this.debug(\"dma name: \" + dmaInfo.DMAName);\t\n\t\t\t\t_this.loadDMAConfiguration(dmaInfo);\t\t\t\n\t\t\t}\n\t\t};\n\t\t\t\n\t\t//call gateway and get info\n\t\t_this.debug(\"looking up dma\");\n\t\tNGBuzzAPI.lookupDMA(parseInt(_this.buzzId), _this.apiToken, zip, lookupCallback);\n\t};\n\nfunction oc(a)\n{\n  var o = {};\n  for(var i=0;i<a.length;i++)\n  {\n    o[a[i]]='';\n  }\n  return o;\n}\n\n\tthis.loadDMAConfiguration = function(dma)\n\t{\n\t\t//see if we have widget for the selected dma\n\t\t_this.debug(\"finding buzz by prefix\");\n\t\t\n\t\tvar findBuzzCallback = function(buzzIds)\n\t\t{\n\t\t\t//_this.debug(buzzIds);\n\t\t\tif (buzzIds.length > 0)\n\t\t\t{\n\t\t\t\t//log custom3 event for when we load a specific DMA\n\t\t\t\t_this.buzzObj.logGenericEvent(\"custom3\");\n\t\t\t\t\n\t\t\t\t//note: dismiss extras if we have multiples\n\t\t\t\tvar dmaBuzzId = buzzIds[0].BuzzId;\n\n\t\t\t\t_this.loadBuzzConfiguration(dma.DMAName, dmaBuzzId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//use default local news config\n\t\t\t\t_this.loadBuzzConfiguration(_this.masterName, _this.buzzId);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// + dma.DMAName\n\t\t_this.findBuzzByPrefix(_this.buzzNamePrefix + dma.DMAName, findBuzzCallback);\n\t};\n\t\n\tthis.loadBuzzConfiguration = function(dmaName, buzzId)\n\t{\n\t\t//load from cache\n\t\tif (_this.cacheContainsWidgetConfig(dmaName))\n\t\t{\n\t\t\t_this.debug(\"cache already contains config for '\" + dmaName + \"'\");\n\t\t\t_this.loadWidget(_this.configCache[dmaName]);\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t//var widgetConfigUrl = _this.appUrl + \"buzz.ashx?buzzId=\" + buzzId + \"&apiToken=\" + _this.apiToken + \"&load=xmlConfig\";\n\t\tvar widgetConfigUrl = _this.appUrl + \"buzz.ashx?buzzId=\" + buzzId + \"&apiToken=\" + _this.apiToken + \"&load=xmlConfig\";\n\t\t\n\t\t//set up variables for values we need passed along to the callback. ugh.\n\t\t_this.loadBuzzConfigurationCallbackDMAName = dmaName;\n\n\t\tvar scriptUrl = _this.appUrl + _this.proxyPath + \"?url=\" + encodeURIComponent(widgetConfigUrl) + \"&callback=\" + encodeURIComponent(\"NGLocalBuzz.loadBuzzConfigurationCallback\");\n\t\t\n\t\t//note: cache=true and dataType=script\n\t\t$.ajax({url: scriptUrl, cache: true, dataType: \"script\", type: \"GET\", callback: null, data:null});\n\t};\n\t\n\tthis.loadBuzzConfigurationCallbackDMAName = \"\";\n\tthis.loadBuzzConfigurationCallback = function(widgetConfigData)\n\t{\n\t\t//pick up variables;\n\t\tvar dmaName = _this.loadBuzzConfigurationCallbackDMAName;\n\t\t\n\t\tif (widgetConfigData.data)\n\t\t{\n\t\t\tvar widgetConfigXml = _this.parseXml(widgetConfigData.data);\n\t\t\tvar configUrl = $(widgetConfigXml).find(\"configuration configUrl\").text();\n\t\t\t\t\n\t\t\t_this.loadWidgetConfig(dmaName, configUrl, function(data){\n\t\t\t\tif (data.data != \"undefined\")\n\t\t\t\t{\n\t\t\t\t\tvar config = _this.parseXml(data.data);\n\t\t\t\t\t\t\n\t\t\t\t\t_this.configCache[dmaName] = config;\n\t\t\t\t\t_this.loadWidget(config);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//how do we want to deal with an error\n\t\t\t\t\t_this.debug(data.error, true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//note: handle error from proxy?\n\t}\n\t\n\tthis.parseXml = function(xmlString)\n\t{\n\t\tif( window.DOMParser )\n        \t{\n          \t\tvar parser = new DOMParser();\n          \t\tvar xmlDoc = parser.parseFromString(xmlString,\"text/xml\" ) ;\n          \t\treturn xmlDoc;\n        \t}\n        \telse // Internet Explorer\n\t        {\n\t\t        var xmlDoc = new ActiveXObject( \"Microsoft.XMLDOM\" ) ;\n\t\t        xmlDoc.async = \"false\" ;\n\t\t        xmlDoc.loadXML(xmlString) ;\n\t\t        return xmlDoc;\n\t        }\n\t        _this.debug('null xmlDoc in parseXml', true);\n\t}\n\n\tthis.cacheContainsWidgetConfig = function(dmaName)\n\t{\n\t\treturn (_this.configCache[dmaName] != undefined && _this.configCache[dmaName] != null);\n\t}\n\n\tthis.loadWidgetConfig = function(dmaName, configUrl, callback)\n\t{\n\t\t_this.loadWidgetConfigCallbackFunction = callback;\n\t\tvar scriptUrl = _this.appUrl + _this.proxyPath + \"?url=\" + encodeURIComponent(configUrl) + \"&callback=\" + encodeURIComponent(\"NGLocalBuzz.loadWidgetConfigCallback\");\n\n\t\t//note: cache=true and dataType=script\n\t\t$.ajax({url: scriptUrl, cache: true, dataType: \"script\", type: \"GET\", callback: null, data:null});\n\t};\n\t\n\tthis.loadWidgetConfigCallbackFunction = null;\n\tthis.loadWidgetConfigCallback = function(data)\n\t{\n\t\tif (_this.loadWidgetConfigCallbackFunction)\n\t\t{\n\t\t\t_this.loadWidgetConfigCallbackFunction(data);\n\t\t}\n\t}\n\t\n\tthis.toggleLoading = function(displayLoading)\n\t{\t\n\t\tvar outerContainer = $(\".ng_buzzContainer #outerContainer\");\n\t\tvar contentContainer = $(\"#tabContentContainer\", outerContainer);\n\t\tvar loadingContainer = $(\"#loadingContainer\", outerContainer);\n\t\tif (displayLoading == false)\n\t\t{\n\t\t\tloadingContainer.css(\"display\", \"none\");\n\t\t\tcontentContainer.css(\"display\", \"block\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tloadingContainer.css(\"display\", \"block\");\n\t\t\tcontentContainer.css(\"display\", \"none\");\n\t\t}\n\t};\n\t\n\tthis.loadWidget = function(configXml)\n\t{\n\t\t_this.currentConfig = configXml;\n\t\t\n\t\tvar config = $(configXml);\n\t\t\n\t\tvar headerContainer = $(\".ng_buzzContainer #localHeader\");\n\t\t\n\t\t//load high level branding\n\t\tvar stationConfig = config.find(\"station\");\n\t\t_this.currentCallLetters = stationConfig.find(\"callLetters\").text().toLowerCase();\n\t\t\n\t\t//store zip code\n\t\t_this.setZipCode(stationConfig.find(\"zip\").text());\n\n\t\tvar logoImg = $(\"#headerLogo\", headerContainer);\n\t\t\n\t\tvar logoConfig = stationConfig.find(\"logo\");\n\t\tlogoImg.attr(\"src\", logoConfig.text());\n\t\tlogoImg.attr(\"height\", logoConfig.attr(\"height\"));\n\t\tlogoImg.attr(\"width\", logoConfig.attr(\"width\"));\n\t\tlogoImg.attr(\"alt\", stationConfig.find(\"callLetters\").text());\n\t\t\n\t\t$(\"#headerLogoLink\", headerContainer).attr(\"href\", stationConfig.find(\"site\").text());\n\t\t$(\"#headerLogoLink\", headerContainer).attr(\"name\", \"lpos=widget[local_\" + _this.currentCallLetters + \"]&lid=logo\");\n\t\t$(\"#marketName\", headerContainer).html(stationConfig.find(\"market\").text());\n\t\t\n\t\t//display header now that it's customized\n\t\t$(\"#headerBranding\", headerContainer).css(\"visibility\", \"visible\");\n\t\t\n\t\t//load tabs\n\t\tvar menuElem = $(\"#localMenu\");\n\t\t$(\"li\", menuElem).remove();\n\t\t\n\t\tvar feeds = config.find(\"feeds feed\");\n\t\tvar weatherConfig = config.find(\"weather\");\n\t\t\n\t\tvar maxItems = feeds.length;\n\t\tif (weatherConfig.length > 0)\n\t\t{\n\t\t\tmaxItems++;\n\t\t}\n\t\tif (maxItems > 4)\n\t\t{\n\t\t\tmaxItems = 4;\n\t\t}\n\t\tfor (var x = 0; x < maxItems; x++)\n\t\t{\n\t\t\tvar feed;\n\t\t\tif (x == 1)\n\t\t\t{\n\t\t\t\t//weather\n\t\t\t\tfeed = weatherConfig;\n\t\t\t\tif (feed == null)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfeed = (x < 1) ? feed = $(feeds[x]) : $(feeds[x - 1]);\n\t\t\t}\t\t\n\t\t\t\t\n\t\t\tmenuElem.append(\"<li id='localMenu_\" + x + \"'><div>\" + feed.attr(\"tabText\").toUpperCase() + \"</div></li>\");\n\t\t}\n\t\t\n\t\t$(\"li:first\", menuElem).addClass(\"selected\");\n\n\t\t//load content of first tab\n\t\t_this.displayTabContent(0);\n\t\t\n\t\t//add click events to tabs\n\t\t$(\"li\", menuElem).click(_this.tabClicked);\n\t};\n\t\n\tthis.displayTabContent = function(tabIndex)\n\t{\n\t\tvar currentConfig = _this.currentConfig;\n\t\tvar contentContainer = $(\".ng_buzzContainer #tabContentContainer\");\n\t\t\n\t\t//hide all\n\t\t$(\".localContent\", contentContainer).css(\"display\", \"none\");\n\n\t\tvar appendContentContainer = function(tabIndex, contents)\n\t\t{\n\t\t\tcontentContainer.append(\"<div id='localContent_\" + tabIndex + \"' class='localContent'>\" + contents + \"</div>\");\n\t\t\t_this.toggleLoading(false);\n\t\t};\n\n\t\tvar tabsContent = $(\"#localContent_\" + tabIndex, contentContainer);\n\t\t//_this.debug(tabsContent);\n\t\tif (tabsContent.length > 0)\n\t\t{\n\t\t\t//dispaly rendered item\n\t\t\t_this.toggleLoading(false);\n\t\t\ttabsContent.css(\"display\", \"block\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//render new tab\n\t\t\tvar output;\n\t\t\tif (tabIndex == 1)\n\t\t\t{\n\t\t\t\tvar wConfig = $(currentConfig).find(\"weather\");\n\t\t\t\tvar weatherObj = {\n\t\t\t\t\tcallLetters: _this.currentCallLetters,\n\t\t\t\t\theaderText: wConfig.attr(\"headerText\"),\n\t\t\t\t\tlinks: [],\n\t\t\t\t\timage: null,\n\t\t\t\t\taltImage: null\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tvar iConfig = wConfig.find(\"img\");\n\t\t\t\tif (iConfig.length != 0)\n\t\t\t\t{\n\t\t\t\t\tweatherObj.image = {\n\t\t\t\t\t\tsrc: iConfig.text(),\n\t\t\t\t\t\turl: iConfig.attr(\"url\"),\n\t\t\t\t\t\tdescription: iConfig.attr(\"description\"),\n\t\t\t\t\t\theight: iConfig.attr(\"height\"),\n\t\t\t\t\t\twidth: iConfig.attr(\"width\")\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar aiConfig = wConfig.find(\"altImg\");\n\t\t\t\tif (aiConfig.length != 0)\n\t\t\t\t{\n\t\t\t\t\tweatherObj.altImage = {\n\t\t\t\t\t\taltText: aiConfig.attr(\"altImgText\"),\n\t\t\t\t\t\theight: aiConfig.attr(\"height\"),\n\t\t\t\t\t\twidth: aiConfig.attr(\"width\"),\n\t\t\t\t\t\tsrc: aiConfig.text()\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar linkCount = 1;\n\t\t\t\twConfig.find(\"link\").each(function(){\n\t\t\t\t\t//enforce max of 4 links\n\t\t\t\t\tif (linkCount <= 4)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar link = {\n\t\t\t\t\t\t\ttitle: $(this).attr(\"title\"),\n\t\t\t\t\t\t\turl: $(this).text()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tweatherObj.links.push(link);\n\t\t\t\t\t}\n\t\t\t\t\tlinkCount++;\n\t\t\t\t});\n\t\t\t\toutput = _this.buzzObj.renderTemplate($(\"#localWeatherTemplate\").val(), weatherObj);\n\n\t\t\t\tappendContentContainer(tabIndex, output);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\n\t\t\t\tvar itemIndex = tabIndex;\n\t\t\t\tif (tabIndex != 0)\n\t\t\t\t{\n\t\t\t\t\titemIndex--;\n\t\t\t\t}\n\t\t\t\tvar nFeeds = $(currentConfig).find(\"feeds feed\");\n\t\t\t\t\n\t\t\t\tvar nFeed = $(nFeeds[itemIndex]);\n\t\t\t\t//_this.debug(nFeed);\n\t\t\t\tvar maxPosts = parseInt(nFeed.attr(\"count\"), 10);\n\t\t\t\tif (maxPosts > 6)\n\t\t\t\t{\n\t\t\t\t\tmaxPosts = 6;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar feedUrl = nFeed.find(\"url\").text();\n\t\t\t\t//local feed with thumbnails\n\t\t\t\t//feedUrl = \"http://abcnews.go.com/xmldata/rss?id=7217216\";\n\t\t\t\t//feedUrl = \"http://cdn.abclocal.go.com/kfsn/xml?id=7110337&ptnr=abcnewsLocal\";\n\n\n\t\t\t\t_this.ng_loadWidgetData(_this.buzzId, _this.apiToken, \"loadData_\" + _this.buzzId, feedUrl, 12, function(data){\n\t\t\t\t\tvar tabName = (parseInt(tabIndex, 10) == 0) ? \"news\" : \"wildcard\";\n\t\t\t\t\t\n\t\t\t\t\t//sort the posts by the MediaRSS.Keywords property\n\t\t\t\t\tvar sortedPosts = data.Data;\n\t\t\t\t\tsortedPosts = sortedPosts.sort(function(a, b) {\n\t\t\t\t\t\tvar aInt = 100;\n\t\t\t\t\t\tvar bInt = 100;\n\t\t\t\t\t\t\n\t\t\t\t\t\t//parse so we sort numerically instead of alphabetically\n\t\t\t\t\t\tif (a.MediaRSS && a.MediaRSS.Keywords)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\taInt = parseInt(a.MediaRSS.Keywords, 10);\n\t\t\t\t\t\t\tif (isNaN(aInt)) aInt = 100;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (b.MediaRSS && b.MediaRSS.Keywords)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbInt = parseInt(b.MediaRSS.Keywords, 10);\n\t\t\t\t\t\t\tif (isNaN(bInt)) bInt = 100;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (aInt == bInt)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn (aInt < bInt) ? -1 : 1;\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tvar newsObj = {\n\t\t\t\t\t\tcallLetters: _this.currentCallLetters,\n\t\t\t\t\t\ttabPosition: parseInt(tabIndex, 10) + 1,\n\t\t\t\t\t\ttabName: tabName,\n\t\t\t\t\t\theaderText: nFeed.attr(\"headerText\"),\n\t\t\t\t\t\tcount: nFeed.attr(\"count\"),\n\t\t\t\t\t\tposts: sortedPosts\n\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\t\t//render section\n\t\t\t\t\toutput = _this.buzzObj.renderTemplate($(\"#localStoryTemplate\").val(), newsObj);\n\n\t\t\t\t\tappendContentContainer(tabIndex, output);\n\t\t\t\t});\n\t\t\t}\t\t\t\n\t\t}\n\t}\n\n\tthis.ng_loadWidgetData = function(buzzId, apiToken, jsonPName, xmlUrl, maxPosts, callback)\n\t{\n\t\tvar scriptUrl = _this.appUrl + \"/buzz.ashx?load=data&buzzId=\" + buzzId + \"&apiToken=\" + apiToken + \"&XmlUrl=\" + encodeURIComponent(xmlUrl) + \"&maxPosts=\" + maxPosts + \"&jsonp=\" + jsonPName;\n\n\t\t//create script element\n\t\tvar s = document.createElement(\"SCRIPT\");\n\t\ts.src = scriptUrl;\n\n\t\t//function to handle callback and cleanup\n\t\tfunction invokeCallback(){\n\t\t\tvar data = window[jsonPName];\n\t\t\ttry{\n\t\t\t\tcallback(data);\n\t\t\t} catch(e){\n\t\t\t}\n\n\t\t\n\t\t\t//set timeout to cleanup after ourselves\n\t\t\tsetTimeout(function(){\n\t\t\t\ts.parentNode.removeChild(s);\n\t\t\t\twindow[jsonPName] = null;\n\t\t\t}, 1);\n\t\t};\n\n\t\tif(ng_isIE){\n\t\t\t//IE doesn't support onload for script tags. Do polling for variable name\t\t\n\t\t\tvar startDate = new Date();\n\t\t\tvar checkhandle = setInterval(function(){\n\t\t\t\tif(window[jsonPName]){\n\t\t\t\t\tclearInterval(checkhandle);\n\t\t\t\t\tinvokeCallback(window[jsonPName]);\n\t\t\t\t} else  if((new Date()).getTime() - startDate.getTime() > 30000){\n\t\t\t\t\tclearInterval(checkhandle);\n\t\t\t\t\tinvokeCallback([]);\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t} else {\n\t\t\ts.onload = invokeCallback\n\t\t}\n\n\t\t//append script element to document\n\t\tdocument.getElementsByTagName(\"HEAD\")[0].appendChild(s);\n\t};\n\n\t\n\tthis.tabClicked = function()\n\t{\n\t\t_this.toggleLoading(true);\n\t\t\n\t\t//deselect all tabs\n\t\t$(\"#localMenu li\").removeClass(\"selected\");\n\t\t//selet this tab\n\t\t$(this).addClass(\"selected\");\n\t\t\n\t\tvar id = this.id.substring(this.id.indexOf(\"_\") + 1);\n\t\t_this.displayTabContent(id);\n\t};\n\t\n\tthis.findBuzzByPrefix = function(prefix, callback)\n\t{\n\t\tif (_this.orgCode == null)\n\t\t{\n\t\t\tthis.debug(\"orgCode must be defined\", true);\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar idsFound = null;\n\t\tvar findBuzzCallback = function(a, res, c)\n\t\t\t{\n\t\t\t\tif (res.error != \"\")\n\t\t\t\t{\n\t\t\t\t\t//error handling\n\t\t\t\t\t_this.debug(res.error, true);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\telse if (res.result == undefined)\n\t\t\t\t{\n\t\t\t\t\tif (noBuzzPrefixFoundEvents == null) \n\t\t\t\t\t{\n\t\t\t\t\t\t_this.debug(\"no buzz matching prefix found\", true);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{ executeEvents(noBuzzPrefixFoundEvents); }\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn res.result;\n\t\t\t\t}\n\t\t\t};\n\t\t\n\t\t//find buzz\n\t\tNGBuzzAPI.findBuzzIDsByPrefix(parseInt(_this.buzzId), _this.apiToken, _this.orgCode, prefix,\n\t\t\tfunction(a, res, c)\n\t\t\t{\n\t\t\t\tidsFound = findBuzzCallback(a, res, c);\t\n\t\t\t\t\n\t\t\t\tcallback(idsFound);\n\t\t\t});\n\t};\n\t\n\tthis.loadOtherLocations = function()\n\t{\n\t\t_this.debug(\"loading other locations\");\n\t\t_this.findBuzzByPrefix(_this.buzzNamePrefix, function(data){\n\n\t\t\tvar ddl = $(\".ng_buzzContainer #locationDDL\");\n\t\t\tddl.children().remove();\n\t\t\t\n\t\t\tvar options = \"<option value=''>-- Change Location --</option>\";\n\t\t\t\n\t\t\tvar modData = data;\n\n\t\t\tvar modWidgetConfig = {}\n\t\t\tfor (var key in _this.buzzObj.settingsObj.WidgetConfiguration)\n\t\t\t{\n\t\t\t\tmodWidgetConfig[key.toLowerCase()] = _this.buzzObj.settingsObj.WidgetConfiguration[key];\n\t\t\t}\n\t\t\t\n\t\t\t$(modData).each(function(){\n\t\t\t\tthis.DMAName = this.BuzzName.substring(_this.buzzNamePrefix.length);\n\t\t\t\t\n\t\t\t\t//remove special characters that we can't have in the key (hyphen, space, (, ), period, and comma)\n\t\t\t\tvar key = this.DMAName.replace(/(-| |\\(|\\)|\\.|,|&)/g, \"\");\n\t\t\t\tkey = key.toLowerCase();\n\n\t\t\t\tif (modWidgetConfig[key] != \"undefined\" && modWidgetConfig[key] != null)\n\t\t\t\t{\n\t\t\t\t\tthis.friendlyName = modWidgetConfig[key];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.friendlyName = this.DMAName;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//FlintSaginawBayCity\n\t\t\t\t//console.log(_this.buzzObj.settingsObj.ExtraArgs);\n\t\t\t});\n\t\t\t\n\t\t\tvar sortedData = modData.sort(function(a, b) {\n\t\t\t\tif(a.friendlyName == b.friendlyName)\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\treturn (a.friendlyName < b.friendlyName) ? -1 : 1;\n\t\t\t});\n\t\t\t\n\t\t\t$(sortedData).each(function(){\n\t\t\t\tif (this.DMAName != _this.masterName)\n\t\t\t\t{\n\t\t\t\t\toptions += \"<option value='\" + this.BuzzId + \"'>\" + this.friendlyName + \"</option>\";\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t_this.otherLocations = sortedData;\n\t\t\t\n\t\t\tddl.html(options);\n\t\t\t\n\t\t\tddl.change(_this.changeDMA);\n\t\t\tddl.css(\"visibility\", \"visible\");\n\t\t});\n\t};\n\t\n\tthis.changeDMA = function()\n\t{\t\n\t\tvar selectedId = $(\".ng_buzzContainer #locationDDL\").val();\n\t\t\n\t\tif (selectedId == \"\") return;\n\t\t\n\t\t_this.clearTabsAndContent();\n\t\t_this.toggleLoading(true);\n\t\t\n\t\tvar loc = null;\n\t\tfor (var x = 0; x < _this.otherLocations.length; x++)\n\t\t{\n\t\t\tvar currentLocation = _this.otherLocations[x];\n\t\t\t//_this.debug(currentLocation);\n\t\t\tif (currentLocation.BuzzId == selectedId)\n\t\t\t{\n\t\t\t\tloc = currentLocation;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\t//log how many times the DMA is manually changed\n\t\t_this.buzzObj.logGenericEvent(\"custom2\");\n\t\t\n\t\t_this.loadBuzzConfiguration(loc.DMAName, loc.BuzzId);\n\t};\n\t\n\tthis.clearTabsAndContent = function()\n\t{\n\t\tvar headerContainer = $(\".ng_buzzContainer #localHeader\");\n\t\t$(\"#headerBranding\", headerContainer).css(\"visibility\", \"hidden\");\n\t\t$(\"#localMenu\").children().remove();\n\t\t$(\"#tabContentContainer\").children().remove();\n\t}\n\t\n\tthis.removeEvents = function(eventName)\n\t{\n\t\teval(eventName + \" = null\");\n\t};\n\n\tthis.addEvent = function(eventName, action)\n\t{\n\t\teval(\"var oldEvents = \" + eventName);\n\t\tif (typeof oldEvents != \"function\")\n\t\t{\n\t\t\teval(eventName + \" = action\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\teval(eventName + \" = \" \n\t\t\t\t+ function()\n\t\t\t\t{\n\t\t\t\t\toldEvents();\n\t\t\t\t\taction();\n\t\t\t\t});\n\t\t}\n\t};\n\n\t//internal method\n\tvar executeEvents = function(eventObj)\n\t{\n\t\tif (eventObj != null)\n\t\t{\n\t\t\teventObj(_this);\n\t\t}\n\t};\n\t\n\tthis.getCookie = function(name)\n\t{\n\t\tvar cookie = document.cookie.split(\"; \");\n\t\tfor (var i=0; i < cookie.length; i++)\n\t\t{\n\t\t\tvar crumb = cookie[i].split(\"=\");\n\t\t\tif (name == crumb[0])\n\t\t\t{\n\t\t\t\treturn unescape(crumb[1]);\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tthis.setCookie = function(name, value)\n\t{\n\t\tvar date = new Date();\n\t\tdate.setTime(date.getTime()+(180*24*60*60*1000));\n\t\tdocument.cookie = name + \"=\" + escape(value) + \"; expires=\" + date.toGMTString();\n\t\t//document.cookie = name + \"=\" + escape(value) + \"; expires=Mon, 1 May 2016 23:59:59 UTC\";\n\t};\n\t\n\tthis.deleteCookie = function(name)\n\t{\n\t\tvar cookie = document.cookie.split(\"; \");\n\t\tfor (var i=0; i < cookie.length; i++)\n\t\t{\n\t\t\tvar crumb = cookie[i].split(\"=\");\n\t\t\tif (name == crumb[0])\n\t\t\t{\n\t\t\t\tdocument.cookie = name + \"=\" + escape(crumb[1]) + \"; expires=Thu, 01-Jan-1970 00:00:01 GMT\"\n\t\t\t}\n\t\t}\n\t};\n\t\n\tthis.debug = function(val, isError, stringVal)\n\t{\n\t\tif (_this.enableDebugOutput == false) return;\n\t\t\n\t\ttry{\n\t\t\tif (isError == true)\n\t\t\t{\n\t\t\t\tconsole.error(val);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconsole.log(val);\t\n\t\t\t}\n\t\t\t\n\t\t} catch (e){}\n\t\t\n\n\t\t//output to debug container in page\n\t\tif (!stringVal)\n\t\t{\n\t\t\tstringVal = val.toString();\n\t\t} \n\t\tvar item = $(\"<div>\" + val.toString() + \"</div>\");\n\t\t$(\"#ng_debugoutput\").append(item);\n\t};\n}\n\n\nvar NGLocalBuzz = new NGLocalBuzz_Class();";

try{window.ngbuzzScriptsLoaded = window.ngbuzzScriptsLoaded || {}; window.ngbuzzScriptsLoaded['231983'] = true; ng.buzz.scriptsLoaded['231983']=true;}catch(e){}