(function(h){h.fn.indexer=function(i){return this[0]&&e(this[0],i)||null};h.indexer=function(i){return e(document,i)};var d=h.event,a=d.special,g=h.listen=function(j,l,i,k){if(typeof l!="object"){k=i;i=l;l=document}f(j.split(/\s+/),function(n){n=g.fixes[n]||n;var m=e(l,n)||e(l,n,new b(n,l));m.append(i,k);m.start()})},e=function(j,i,k){return h.data(j,i+".indexer",k)};h.extend(g,{regex:/^((?:\w*?|\*))(?:([#.])([\w-]+))?$/,fixes:{focus:"focusin",blur:"focusout"},cache:function(i){this.caching=i}});h.each(g.fixes,function(j,i){a[i]={setup:function(){if(h.browser.msie){return false}this.addEventListener(j,a[i].handler,true)},teardown:function(){if(h.browser.msie){return false}this.removeEventListener(j,a[i].handler,true)},handler:function(k){arguments[0]=k=d.fix(k);k.type=i;return d.handle.apply(this,arguments)}}});h.fn.listen=function(j,i,k){return this.each(function(){g(j,this,i,k)})};function b(i,j){h.extend(this,{ids:{},tags:{},listener:j,event:i});this.id=b.instances.push(this)}b.instances=[];b.prototype={constructor:b,handle:function(j){var i=j.stopPropagation;j.stopPropagation=function(){j.stopped=true;i.apply(this,arguments)};e(this,j.type).parse(j);j.stopPropagation=i;i=j.data=null},on:false,bubbles:false,start:function(){if(!this.on){d.add(this.listener,this.event,this.handle);this.on=true}},stop:function(){if(this.on){d.remove(this.listener,this.event,this.handle);this.on=false}},cache:function(j,i){return h.data(j,"listenCache_"+this.id,i)},parse:function(l){var k=l.data||l.target,j=arguments,i;if(!g.caching||!(i=this.cache(k))){i=[];if(k.id&&this.ids[k.id]){c(i,this.ids[k.id])}f([k.nodeName,"*"],function(m){var n=this.tags[m];if(n){f((k.className+" *").split(" "),function(o){if(o&&n[o]){c(i,n[o])}})}},this);if(g.caching){this.cache(k,i)}}if(i[0]){f(i,function(m){if(m.apply(k,j)===false){l.preventDefault();l.stopPropagation()}})}if(!l.stopped&&(k=k.parentNode)&&(k.nodeName=="A"||this.bubbles&&k!=this.listener)){l.data=k;this.parse(l)}i=j=k=null},append:function(i,j){f(i.split(/\s*,\s*/),function(m){var n=g.regex.exec(m);if(!n){throw'$.listen > "'+m+'" is not a supported selector.'}var o=n[2]=="#"&&n[3],l=n[1].toUpperCase()||"*",k=n[3]||"*";if(o){(this.ids[o]||(this.ids[o]=[])).push(j)}else{if(l){l=this.tags[l]=this.tags[l]||{};(l[k]||(l[k]=[])).push(j)}}},this)}};function f(j,o,n){for(var m=0,k=j.length;m<k;m++){o.call(n,j[m],m)}}function c(i,j){i.push.apply(i,j);return i}h(window).unload(function(){if(typeof b=="function"){f(b.instances,function(i){i.stop();h.removeData(i.listener,i.event+".indexer");i.ids=i.names=i.listener=null})}})})(jQuery);