var BV=new function(){var _bv,_iProgress,_sFrom,_sTo;this.InitRoot=function(sBvSandboxUrl,sRef,sLayout,sDisplayLanguage,sFromLanguage,sToLanguage,sTransUrl){if(sTransUrl&&location.search&&location.search.indexOf("f=1")>-1){var aQuery=location.search.split("&"),aTransQuery=[];for(var i=0;i<aQuery.length;++i){var mQuery=aQuery[i].match(/(\w+)=(.*)/);if(mQuery&&mQuery[1].toLowerCase()!="lo"&&mQuery[1].toLowerCase()!="dl"&&mQuery[1].toLowerCase()!="mkt"&&mQuery[1].toLowerCase()!="from"&&mQuery[1].toLowerCase()!="to"&&mQuery[1].toLowerCase()!="a"&&mQuery[1].toLowerCase()!="f"&&mQuery[1].toLowerCase()!="ref")aTransQuery.push(mQuery[0])}sTransUrl+=(sTransUrl.indexOf("?")==-1?"?":"&")+aTransQuery.join("&")}sBvSandboxUrl=sBvSandboxUrl+"?"+(sRef?"ref="+sRef:"")+(sLayout?"&lo="+sLayout:"")+(sDisplayLanguage?"&dl="+sDisplayLanguage:"")+(sFromLanguage?"&from="+sFromLanguage:"")+(sToLanguage?"&to="+sToLanguage:"")+(sTransUrl?"&a="+encodeURIComponent(sTransUrl):"");var eRequestForm=document.getElementById("RequestForm");if(eRequestForm){eRequestForm.target="SandboxFrame";eRequestForm.action=sBvSandboxUrl;eRequestForm.submit()}else document.getElementById("SandboxFrame").src=sBvSandboxUrl};this.Init=function(strBvRootUrl,strBvSandboxUrl,strUrlHash,perfEditsEnabled){this.strBvRootUrl=strBvRootUrl;this.strBvSandboxUrl=strBvSandboxUrl;this.strUrlHash=strUrlHash;this.elemLblSecureLink=document.getElementById("lblSecureLink");this.elemLblAutoDetect=document.getElementById("lblAutoDetect");this.elemFrmSrc=Layout.Properties.SrcFrame;if(this.elemFrmSrc==null){this.elemFrmSrc=document.createElement("iframe");this.elemFrmSrc.id="frmSrc";this.elemFrmSrc.frameBorder=0;document.getElementById("divSrcFrm").appendChild(this.elemFrmSrc)}this.elemFrmTgt=Layout.Properties.TgtFrame;if(this.elemFrmTgt==null){this.elemFrmTgt=document.createElement("iframe");this.elemFrmTgt.id="frmTgt";this.elemFrmTgt.frameBorder=0;document.getElementById("divTgtFrm").appendChild(this.elemFrmTgt)}Layout.Methods.SetSourceTarget(this.elemFrmSrc,this.elemFrmTgt);if(!window.Microsoft)return;var aLangCodes=Microsoft.Translator.getLanguages(),aLangNames=Microsoft.Translator.getLanguageNames(document.getElementById("locale").content);this.oLangNames={};for(var i=0;i<aLangCodes.length;++i)this.oLangNames[aLangCodes[i].toLowerCase()]=aLangNames[i];this.strAddress=Util.GetDocumentUrl(document);LangPair.Init();this.bSrcFrmLoaded=this.bTgtFrmLoaded=false;if(this.strAddress){var sURL=encodeURIComponent(this.strAddress);if(sURL.length>400)sURL=sURL.substr(0,400);var strProtocol=this.strAddress.substr(0,this.strAddress.indexOf("://")).toLowerCase();if(strProtocol=="https")if(securePrompt())top.location.href=this.strAddress;else{BV.Progress.End();return}BV.Progress.Begin();if(Layout.Properties.ActiveView=="TP"){this.elemFrmSrc.src="about:blank";this.elemFrmTgt.src="proxy.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress)}else if(Layout.Properties.ActiveView=="SP"){this.elemFrmSrc.src="proxy.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress);this.elemFrmTgt.src="about:blank"}else this.elemFrmSrc.src="proxy.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress)}else{this.elemRequestForm=document.getElementById("RequestForm");if(document.getElementById("postbackonload")){BV.Go();return}var eText=document.getElementById("text");if(this.elemRequestForm&&eText){var sDocumentText=eText.value;this.elemFrmSrc.contentWindow.document.open();this.elemFrmTgt.contentWindow.document.open();if(perfEditsEnabled){this.elemFrmSrc.contentWindow.onload=function(){BV.onPostRender(BV.elemFrmSrc.contentWindow)};this.elemFrmTgt.contentWindow.onload=function(){BV.onPostRender(BV.elemFrmTgt.contentWindow)}}else{this.elemFrmSrc.contentWindow.onload=function(){setTimeout(function(){BV.onPostRender(BV.elemFrmSrc.contentWindow)},0)};this.elemFrmTgt.contentWindow.onload=function(){setTimeout(function(){BV.onPostRender(BV.elemFrmTgt.contentWindow)},0)}}if(Layout.Properties.ActiveView=="TP"){this.elemFrmSrc.contentWindow.document.write("");this.elemFrmTgt.contentWindow.document.write(sDocumentText)}else if(Layout.Properties.ActiveView=="SP"){this.elemFrmSrc.contentWindow.document.write(sDocumentText);this.elemFrmTgt.contentWindow.document.write("")}else{this.elemFrmSrc.contentWindow.document.write(sDocumentText);this.elemFrmTgt.contentWindow.document.write(sDocumentText)}this.elemFrmSrc.contentWindow.document.close();this.elemFrmTgt.contentWindow.document.close()}}if(window==top)top.location.replace("/error.aspx")};this.Go=function(aParams){var aParam="",ctl=Layout.Properties.UrlInput;if(ctl!=null)aParam=ctl.value.replace(/\s+/g,"");if(aParam=="http://")aParam="";var sBvRootUrl=BV.strBvRootUrl+"bv.aspx?"+(aParams?"&"+aParams.join("&")+"&":"")+"from="+LangPair.strFromLang+"&to="+LangPair.strToLang+(aParam?"&a="+encodeURIComponent(aParam):"");_sFrom=LangPair.strFromLang;_sTo=LangPair.strToLang;if(aParam)top.location.href=sBvRootUrl;else if(BV.elemRequestForm){BV.elemRequestForm.target="_top";BV.elemRequestForm.action=sBvRootUrl;BV.elemRequestForm.submit()}};this.OnKeyPress=function(that,evnt){var keyCode=window.event?event.keyCode:evnt?evnt.which:0;if(keyCode==13){BV.Go();return false}};this.onPreRender=function(frameWindow,strAddress){if(strAddress.indexOf("https://")==0){if(!BV.securePrompted){BV.securePrompted=true;if(securePrompt())top.location.replace(strAddress);else history.back()}BV.Progress.End();frameWindow.location.replace("about:blank")}else{if(frameWindow==BV.elemFrmSrc.contentWindow&&(Layout.Properties.ActiveView=="SS"||Layout.Properties.ActiveView=="TB"))BV.elemFrmTgt.src="proxy.ashx?h="+this.strUrlHash+"&a="+encodeURIComponent(BV.strAddress);BV.strAddress=Layout.Properties.UrlInput.value=strAddress}_sFrom=LangPair.strFromLang;_sTo=LangPair.strToLang};this.onPostRender=function(frameWindow){rewriteLinks(frameWindow.document.getElementsByTagName("a"));rewriteLinks(frameWindow.document.getElementsByTagName("area"));rewriteForms(frameWindow.document.getElementsByTagName("form"));var framesRewritten=false;if(rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("frame")))framesRewritten=true;if(rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("iframe")))framesRewritten=true;if(frameWindow==BV.elemFrmSrc.contentWindow)BV.bSrcFrmLoaded=true;else if(frameWindow==BV.elemFrmTgt.contentWindow){BV.bTgtFrmLoaded=true;if(LangPair.strToLang.toLocaleLowerCase()=="tlh-qon")BV.AddKlingonFontToTargetFrame(BV.elemFrmTgt.contentWindow.document.body||BV.elemFrmTgt.contentWindow.document.body)}if((BV.bSrcFrmLoaded||Layout.Properties.ActiveView=="TP")&&(BV.bTgtFrmLoaded||Layout.Properties.ActiveView=="SP")&&!BV.bTranslateRunning){setTimeout(BV.onFramesLoaded,framesRewritten?2000:0);BV.bTranslateRunning=true}};this.AddKlingonFontToTargetFrame=function(node){if(node.nodeType==3){node.parentNode.style.fontFamily="";var styleString=node.parentNode.getAttribute("style");if(styleString)node.parentNode.setAttribute("style",styleString+";font-family:'Klingon' !important;");else node.parentNode.setAttribute("style","font-family:'Klingon' !important;")}for(var i=0;i<node.childNodes.length;i++)BV.AddKlingonFontToTargetFrame(node.childNodes[i])};this.onFramesLoaded=function(){_bv=new Microsoft.Translator.BilingualViewer(BV.elemFrmSrc.contentWindow.document,BV.elemFrmTgt.contentWindow.document,LangPair.strFromLang,LangPair.strToLang);var showTooltips=Layout.Properties.ActiveView=="SP"||Layout.Properties.ActiveView=="TP";_bv.setTooltips(showTooltips,showTooltips);_bv.translate(BV.translateComplete,function(sError){},function(nProgress){BV.Progress.Update(Math.max(Math.floor(nProgress),1));var detLang=_bv.getDetectedLanguage();if(LangPair.strFromLang==""&&!LangPair.autoSet&&detLang&&BV.oLangNames[detLang]){LangPair.autoSet=true;LangPair.SetAutoDetectLanguage(BV.elemLblAutoDetect.innerHTML.replace("{0}",BV.oLangNames[detLang]),detLang)}})};this.translateComplete=function(){BV.Progress.End()};this.SetView=function(v){Util.SetCookie("lo",v,true);Layout.Methods.SetView(v);BV.Go(["lo="+v])};this.Progress={Begin:function(){Layout.Methods.BeginAnimation()},End:function(){Layout.Methods.EndAnimation(false)},Update:function(n){_iProgress=n;Layout.Methods.ShowAnimationPercent(n)},Hide:function(){Layout.Methods.EndAnimation(true)}};this.ReportPage=function(){var prms=[];prms[prms.length]="agent="+encodeURIComponent(navigator.userAgent);prms[prms.length]="loc="+encodeURIComponent(navigator.language||navigator.browserLanguage);prms[prms.length]="to="+encodeURIComponent(_sTo||LangPair.strToLang);prms[prms.length]="from="+encodeURIComponent(_sFrom);prms[prms.length]="url="+encodeURIComponent(BV.strAddress);prms[prms.length]="lo="+encodeURIComponent(Layout.Properties.ActiveView);if(_bv){prms[prms.length]="prgrs="+encodeURIComponent(_iProgress);if(window.Microsoft.Translator.APIResponses>0)prms[prms.length]="dtc="+encodeURIComponent(_bv.getDetectedLanguage());prms[prms.length]="reqCnt="+encodeURIComponent(window.Microsoft.Translator.APIRequests);prms[prms.length]="resCnt="+encodeURIComponent(window.Microsoft.Translator.APIResponses)}else prms[prms.length]="stat="+encodeURIComponent("Page's not loaded");Util.Log("BVPages",prms);Layout.Methods.HideBVReport();Layout.Methods.ShowBVThanksReporting()};function rewriteLinks(aLinks){for(var i=0;i<aLinks.length;++i)try{if(aLinks[i].href)if(aLinks[i].href.indexOf("http://")==0){var sTmpHTML=aLinks[i].innerHTML;aLinks[i].href=BV.strBvRootUrl+"bv.aspx?from="+LangPair.strFromLang+"&to="+LangPair.strToLang+"&a="+encodeURIComponent(aLinks[i].href);aLinks[i].innerHTML=sTmpHTML;aLinks[i].onclick=function(){};aLinks[i].target="_top"}else if(aLinks[i].href.indexOf("https://")==0){aLinks[i].onclick=securePrompt;aLinks[i].target="_top"}}catch(oError){}}function rewriteForms(aForms){for(var i=0;i<aForms.length;++i){aForms[i].target="_top";if(aForms[i].method==null||aForms[i].method=="undefined")continue;if(aForms[i].method.length==0||aForms[i].method.toLowerCase()=="get")rewriteForm(aForms[i])}}function rewriteForm(eForm){try{var sAddress=eForm.action?eForm.action:BV.strAddress;if(sAddress.indexOf("://")==-1){var mBaseMatch=BV.strAddress.match(/^([^:]*:\/\/[^\/]*)(\/[^\?\#]*)/),aPath=sAddress.substr(0,1)=="/"?[]:mBaseMatch[1].split("/"),mPathMatch=sAddress.match(/^([^?]*)(.*)$/),aRel=mPathMatch[1].split("/"),sQuery=mPathMatch[2];if(aPath.length>0&&aRel.length>0&&aRel[0]!=".")aPath.pop();while(aRel.length>0){var sRel=aRel.shift();switch(sRel){case ".":break;case "..":if(aPath.length)aPath.pop();break;default:aPath.push(sRel);break}}sAddress=mBaseMatch[1]+aPath.join("/")+sQuery}eForm.action=BV.strBvRootUrl+"bv.aspx";var eFrom=eForm.ownerDocument.createElement("input");eFrom.name="from";eFrom.type="hidden";eFrom.value=LangPair.strFromLang;eForm.appendChild(eFrom);var eTo=eForm.ownerDocument.createElement("input");eTo.name="to";eTo.type="hidden";eTo.value=LangPair.strToLang;eForm.appendChild(eTo);var eAddress=eForm.ownerDocument.createElement("input");eAddress.name="a";eAddress.type="hidden";eAddress.value=sAddress;eForm.appendChild(eAddress);var eSubForm=eForm.ownerDocument.createElement("input");eSubForm.name="f";eSubForm.type="hidden";eSubForm.value="1";eForm.appendChild(eSubForm);eForm.onsubmit=function(){eFrom.value=LangPair.strFromLang;eTo.value=LangPair.strToLang;eAddress.value=sAddress;eSubForm.value="1"}}catch(excp){}}function rewriteFrames(frameWindow,aFrames){var framesRewritten=false;if(aFrames.length)frameWindow.BV={onPreRender:function(frameWindow){},onPostRender:function(frameWindow){rewriteLinks(frameWindow.document.getElementsByTagName("a"));rewriteLinks(frameWindow.document.getElementsByTagName("area"));rewriteForms(frameWindow.document.getElementsByTagName("form"));rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("frame"));rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("iframe"))}};for(var i=0;i<aFrames.length;++i)try{if(aFrames[i].src&&aFrames[i].src.toLowerCase().indexOf("javascript:")==-1&&aFrames[i].src.toLowerCase().indexOf("about:")==-1){var frameDomain=aFrames[i].src.match(/http:\/\/([^:\/]+)/i);if(frameDomain&&frameDomain[1]&&BV.strAddress.indexOf(frameDomain[1])==-1)continue;aFrames[i].src=BV.strBvSandboxUrl+"proxy.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(BV.strAddress)+"&b="+encodeURIComponent(aFrames[i].src);framesRewritten=true}}catch(excp){}return framesRewritten}function securePrompt(){return confirm(BV.elemLblSecureLink.innerHTML)}return this};Default=new CDefault;function CDefault(){return this}String.prototype.format=function(){for(var i=1;i<arguments.length;i++){var exp=new RegExp("\\{"+(i-1)+"\\}","gm");arguments[0]=arguments[0].replace(exp,arguments[i])}return arguments[0]};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.trimEncoded=function(){return this.replace(/^%20+|%20+$/g,"")};String.prototype.trimCr=function(){var s=this.trim();s=s.replace(/^[\n\r]+|[\n\r]+$/g,"");return s.trim()};String.prototype.startsWith=function(str,ignorecase){if(arguments.length==0)return false;if(arguments.length!=2)ignorecase=true;var me=this.trimCr();if(str.length==0||me.length<str.length)return false;var subtxt=me.substr(0,str.length);if(ignorecase){str=str.toLowerCase();subtxt=subtxt.toLowerCase()}return subtxt==str};String.prototype.containsWhiteSpace=function(){var whitespace=new RegExp(Default.Constants.ContainsWhiteSpace);return whitespace.test(this)};String.prototype.isEmpty=function(){var me=this;me=me.trimCr();me=me.replace(new RegExp(Default.Constants.OneOrMoreSpaces),"");return me.length==0};Default.Constants={StartEndWhiteSpace:/^\s+|\s+$/g,ContainsWhiteSpace:/\s+/g,ValidUrl:/^http:\/\/([A-Za-z0-9-_]+\.[A-Za-z0-9]{2,})[A-Za-z0-9-#,_%&\?\/.=]+$/i,NewLine:/\r\n/g,OneOrMoreSpaces:/\s+/g,StartsWithSpan:/$<span>/i,SingleSpace:" ",EmptyString:"",InitClass:"mttextareainit",NormClass:"mttextarea",InvisibleClass:"Invisible",PlayText:"",PlayClassName:"Play",SearchBaseUrl:"http://www.bing.com/search?form=MSTLP1&q=",EmailBaseUrl:"mailto:?body=",BvUrl:null,RTTAppID:null,BvLangToParam:null,BvLangFmParam:null,BvTargetUrl:null,VoteRating:1,BlockRating:-1,KeyCode:{ReturnKey:13,ShiftKey:16,CtrlKey:17,AltKey:18},NoHighlightKeys:{ShiftKey:16,CtrlKey:17,AltKey:18,UpArrowKey:38,DownArrowKey:40,LeftArrowKey:37,RightArrowKey:39,PrintScreenKey:44},OverlayHighlightClass:"shighlight",OutputHighlightClass:"dhighlight"};Default.Globals={RTT:false,PhraseAlignment:false,ShiftKeyDown:false,AltKeyDown:false,CtrlKeyDown:false,EscapeKeyDown:false,EscapeKeyDouble:false,PreviousText:"",PreviousFrom:"",PreviousTo:"",PreviousTextRTT:"",RTTCallIteration:0,Initialized:false,AjaxApiUserId:function(Util){var mUserId=document.cookie.match(/mstcid=([^;]+)/i);if(mUserId)mUserId=mUserId[1];else{mUserId=Math.floor(Math.random()*1000000000).toString(16);document.cookie="mstcid="+mUserId+"; expires=Sun, 01-Jan-2040 01:01:01 GMT; path="+Util.GetPath()}return mUserId}(new CUtil)};var $mt=function(id){return document.getElementById(id)};Default.Language={getFrom:function(dflt){var args=arguments,s=LangPair.strFromLang;if(s.length==0&&args.length==1)s=dflt;return s.toLowerCase()},getTo:function(){return LangPair.strToLang.toLowerCase()},setFrom:function(lang){LangPair.setFromLang(lang)},setTo:function(lang){LangPair.setToLang(lang)},getDirection:function(s){var dir="ltr",arr=Default.RtlLanguages.split(",");for(var i=0;i<arr.length;i++)if(arr[i]==s){dir="rtl";break}return dir}};Default.Elements={$mt:function(e){return document.getElementById(e)},get_Body:function(){return document.getElementsByTagName("body")[0]},get_OutputText:function(){return this.$mt("TranslationOutput")},get_AjaxWaitImage:function(){return this.$mt("AjaxWaitImage")},get_SpeakButton:function(){return this.$mt("TTSLink")},get_SearchButton:function(){return this.$mt("TransSearch")},get_EmailButton:function(){return this.$mt("TransEmail")},get_InputText:function(){return this.$mt("InputText")},get_UrlInput:function(){return this.$mt("InputURL")},get_TranslateButton:function(){return this.$mt("TranslateButton")},get_AutoDetectPat:function(){return this.$mt("AutoDetectPat")},get_AutoDetectTxt:function(){return this.$mt("AutoDetectTxt")},get_ClearLink:function(){return this.$mt("Clear")},get_TdTransRating:function(){return this.$mt("TdTransRating")},get_TildeRow:function(){return this.$mt("TildeRow")},get_HmongRow:function(){return this.$mt("HmongRow")},get_UrduRow:function(){return this.$mt("UrduRow")},get_KlingonRow:function(){return this.$mt("KlingonRow")},get_RateRow1:function(){return this.$mt("RateRow1")},get_RateRow2:function(){return this.$mt("RateRow2")},get_SearchClip:function(){return this.$mt("SearchAndClipText")},get_DictionaryTitle:function(){return this.$mt("DictionaryTitle")},get_TranslationTitle:function(){return this.$mt("TranslationTitle")},get_PlayText:function(){return this.$mt("TTSPlayText")},get_OutputCell:function(){return this.$mt("OutputTextHtmlCell")},get_SrcLinkPlaceHolder:function(){return this.$mt("InstText")},get_SrcLink:function(){return this.$mt("pnlUrlLink")},Init:function(){Initialize()},get_RTTLoading:function(){return this.$mt("RTTWaitImage")},Init:function(){Initialize()}};Default.OutputElement={get:function(){return Default.Elements.$mt("TranslationOutput")},getInput:function(){return Default.Elements.$mt("TranslationOutputHidden")},set_ClassName:function(s){this.get().className=s},set_ClassNormal:function(){this.set_ClassName(Default.Constants.NormClass);if(LangPair.strToLang.toLowerCase()=="tlh-qon"){$("#TranslationOutput").removeClass("mttextarea");$("#TranslationOutput").addClass("klingon")}else{$("#TranslationOutput").removeClass("klingon");$("#TranslationOutput").addClass("mttextarea")}},isRTL:function(){return "rtl"==Default.OutputElement.get().getAttribute("dir")},Tags:null,get_SpanTags:function(){var tags=[],aDivs=this.get().getElementsByTagName("div");for(var i=0;i<aDivs.length;++i){var aSpans=aDivs[i].getElementsByTagName("span");if(aSpans.length==0)tags.push(aDivs[i]);else for(var j=0;j<aSpans.length;++j){var t=aSpans[j];if(t.getAttribute("lang"))tags.push(t)}}return tags},set_Width:function(i){this.get().style.width=i+"px"},onKeyDown:function(event){var code=event.keyCode||event.which;if(event.ctrlKey&&String.fromCharCode(code).toLowerCase()=="a"){Default.OutputElement.get().focus();Default.OutputValue.selectAll();if(event.preventDefault)event.preventDefault();if(event.stopPropagation)event.stopPropagation();event.cancelBubble=true;event.returnValue=false;return false}return true},Populate:function(){var outputElem=Default.OutputElement.getInput(),outputNode=Default.OutputElement.get();outputNode.innerHTML="";var alignments=outputElem.getAttribute("mstAlign");alignments=alignments.split("|");var nodes=outputElem.childNodes,div;for(var k=0,m=0;k<nodes.length;k++){if(nodes[k].tagName.toLowerCase()=="br"){outputNode.appendChild(document.createElement("br"));continue}div=document.createElement("div");div.setAttribute("name","div["+m+"]");var alignment=alignments[m],fontElements=nodes[k].getElementsByTagName("font"),translatedText="",lang;for(var font in fontElements)if(fontElements[font].lang){lang=fontElements[font].lang;translatedText+=$(fontElements[font]).text()}if(lang)lang=lang.trim().toLowerCase();if(alignment){var aligns=alignment.split(" "),ag=[];for(var i=0;i<aligns.length;i++)ag[i]=new Default.Utils.Alignment(aligns[i]);function sortFun(a,b){return a.DstBegin>b.DstBegin||a.DstBegin==b.DstBegin&&a.DstEnd>b.DstEnd?1:a.DstBegin==b.DstBegin?0:-1}ag.sort(sortFun);for(var i=0;i<ag.length-1;i++)if(ag[i].DstBegin==ag[i+1].DstBegin){ag[i].DstEnd=ag[i+1].DstEnd;ag.splice(i+1,1);i--}var lastInd=0;for(var i=0;i<ag.length;i++){if(lastInd<ag[i].DstBegin){var node=document.createElement("span");$(node).text(translatedText.substring(lastInd,ag[i].DstBegin));div.appendChild(node)}var node=document.createElement("span"),tmp=translatedText.substring(ag[i].DstBegin,ag[i].DstEnd+1);$(node).text(translatedText.substring(ag[i].DstBegin,ag[i].DstEnd+1));tmp=tmp.trim();if(tmp.length>1||Default.Constants.Separators[lang]&&Default.Constants.Separators[lang].indexOf(tmp)==-1||!Default.Constants.Separators[lang]&&Default.Constants.Separators["en"].indexOf(tmp)==-1){node.setAttribute("id","Dst["+m+"]["+ag[i].Src+":"+ag[i].Dst+"]");node.setAttribute("_mstSrc",m+"_"+ag[i].Src);node.setAttribute("_mstDst",m+"_"+ag[i].Dst);node.setAttribute("onmouseover","Default.UI.PhraseHighlight(this)");node.setAttribute("onmouseout","Default.UI.ClearHighlight()")}div.appendChild(node);lastInd=ag[i].DstEnd+1}if(lastInd<translatedText.length){var node=document.createElement("span");$(node).text(translatedText.substring(lastInd));div.appendChild(node)}}outputNode.appendChild(div);m++}}};Default.OutputValue={get:function(){return this._value||""},set:function(text){var outputElem=Default.OutputElement.get();outputElem.innerHTML="";var texts=text.split(/\n/g),fontNode,divNode;for(var i=0;i<texts.length;++i){texts[i]=texts[i].trim();if(texts[i]){divNode=document.createElement("div");divNode.className="force_dir";fontNode=document.createElement("font");fontNode.appendChild(document.createTextNode(texts[i]));divNode.appendChild(fontNode);outputElem.appendChild(divNode)}else outputElem.appendChild(document.createElement("br"))}this._value=Default.Utils.GetText(outputElem)},setInput:function(text){var outputElem=Default.OutputElement.getInput();outputElem.innerHTML="";var texts=text.split(/\n/g),fontNode,divNode;for(var i=0;i<texts.length;++i){texts[i]=texts[i].trim();if(texts[i]){divNode=document.createElement("div");divNode.className="force_dir";fontNode=document.createElement("font");fontNode.appendChild(document.createTextNode(texts[i]));divNode.appendChild(fontNode);outputElem.appendChild(divNode)}else outputElem.appendChild(document.createElement("br"))}this._value=Default.Utils.GetText(outputElem)},emailText:function(){var emailText=[],aDivs=Default.OutputElement.get().getElementsByTagName("div");for(var i=0;i<aDivs.length;++i){emailText.push(encodeURIComponent(Default.Utils.GetText(aDivs[i]).replace(/\s+/g," "))+"%0D%0A");if(aDivs[i].nextSibling&&aDivs[i].nextSibling.nodeName.toLowerCase()=="br")emailText.push("%0D%0A")}emailText.push(Default.I18n.EmailFooter);emailText=emailText.join("");if(Util.MSIE){if(emailText.length>460)emailText=""}else if(emailText.length>2000)emailText="";return emailText},sync:function(forceSync){var outputElem=Default.OutputElement.getInput(),alignments=outputElem.getAttribute("mstAlign");Default.SourceElement.getOverlay().innerHTML="";var lines=Default.SourceValue.get().split("\n");for(var i=0;i<lines.length;i++)if(lines[i].trim().length==0){lines.splice(i,1);i--}Default.SourceElement.SourceLanguage=LangPair_FromDDL.getValue();if(Default.SourceElement.SourceLanguage=="")Default.SourceElement.SourceLanguage=LangPair.elemFromLangLAD.value;if(forceSync)Default.OutputElement.get().innerHTML=outputElem.innerHTML;else if(alignments==null||alignments.replace("|","").length==0||lines.length!=alignments.split("|").length||!Default.Globals.PhraseAlignment){for(var font in outputElem.getElementsByTagName("font"))if(outputElem.getElementsByTagName("font")[font].lang){Default.OutputElement.get().innerHTML=outputElem.innerHTML;break}}else{var caretPos=Util.GetCaretPosition(Default.SourceElement.get());Default.SourceValue.set(Default.SourceValue.get().replace(/[\t]/g,"    "));Util.SetCaretToPosition(Default.SourceElement.get(),caretPos.end);if(Default.Globals.RTT)Default.Globals.PreviousTextRTT=Default.Globals.PreviousText=Default.Globals.PreviousTextRTT.replace(/[\t]/g,"    ");else Default.Globals.PreviousText=Default.SourceValue.get();Default.SourceElement.PopulateOverlay();Default.OutputElement.Populate();Default.UI.DisableHightlight=false}this._value=Default.Utils.GetText(outputElem)},markURLS:function(){var outputElem=Default.OutputElement.getInput(),exp=/(((http|https)(:\/\/))?[\w\-\S]+(\.[\w\-\S]+)*\.[a-zA-Z]{2,}(\/\S*)?)/gi,text=outputElem.innerHTML;outputElem.innerHTML=text.replace(exp,function(match,capture){if(!capture.match(/\s/))return "<a href='"+Default.Utils.GetBvUrl(capture)+"' class='bvLink' target='_blank'>"+capture+"</a>"})},pre:function(text,id){var outputElem=Default.OutputElement.get(),divNode=document.createElement("div");divNode.innerHTML=text;var divNodeOld=null;if(id){divNodeOld=document.getElementById(id);divNode.setAttribute("id",id)}if(divNodeOld)outputElem.replaceChild(divNodeOld,divNode);else outputElem.insertBefore(divNode,outputElem.firstChild)},add:function(text,id){var outputElem=Default.OutputElement.get(),divNode=document.createElement("div");divNode.innerHTML=text;var divNodeOld=null;if(id){divNodeOld=document.getElementById(id);divNode.setAttribute("id",id)}if(divNodeOld)outputElem.replaceChild(divNodeOld,divNode);else outputElem.appendChild(divNode)},selectAll:function(){var selection,range;if(!Util.MSIE){selection=window.getSelection();range=selection.getRangeAt(0);range.selectNodeContents(Default.OutputElement.get());selection.removeAllRanges();selection.addRange(range)}else{selection=document.selection;selection.clear();range=selection.createRange();range.moveToElementText(Default.OutputElement.get());range.select()}},addHyperLink:function(text){text=Default.Utils.CollapseString(text);var outputElem=Default.OutputElement.getInput();outputElem.innerHTML="";var bvLink=document.createElement("a");bvLink.className="bvLink";var span=document.createElement("span");span.innerHTML=Default.Utils.htmlEncode(text);bvLink.appendChild(span);var encodedText=encodeURIComponent(text);if(encodedText.length<200){bvLink.setAttribute("target","_blank");bvLink.setAttribute("href",Default.Utils.GetBvUrl(encodedText))}else{bvLink.setAttribute("href","javascript:void(0)");bvLink.setAttribute("onclick","Default.Utils.SendUrlTranslationViaPost('"+encodedText+"')")}outputElem.appendChild(bvLink);this.sync(true)},hideOptions:function(){$mt("TransSearch").style.visibility="hidden";$mt("TransEmail").style.visibility="hidden";$mt("TTSLink").style.visibility="hidden"}};Default.SourceElement={SourceLanguage:"",get:function(){return Default.Elements.$mt("InputText")},getOverlay:function(){return document.getElementById("Overlay")},resetOverlay:function(){Default.SourceElement.getOverlay().innerHTML="";Default.UI.DictionaryEntry=false;Default.OutputElement.getInput().setAttribute("mstAlign","")},UpdateOverlayDimensions:function(){var overlay=Default.SourceElement.getOverlay(),inputText=Default.SourceElement.get(),attr=["font-family","font-size","font-weight","font-style","direction","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","overflow-x","overflow-y"];for(var i=0;i<attr.length;i++)$(overlay).css(attr[i],$(inputText).css(attr[i]));$(overlay).width(Default.SourceElement.GetOverlayWidth());if($.browser.msie&&$.browser.version<9)$(overlay).css("white-space","pre-line")},set_ClassName:function(s){this.get().className=s},set_Height:function(i){this.get().setAttribute("height",i+"px")},set_Width:function(i){this.get().setAttribute("width",i+"px")},PopulateOverlay:function(){var alignInfo;if((alignInfo=Default.OutputElement.getInput().getAttribute("mstalign"))==null)return;var lang=LangPair_FromDDL.getValue();if(lang=="")lang=LangPair.elemFromLangLAD.value;var overlay=Default.SourceElement.getOverlay();overlay.style.direction=Default.SourceElement.get().style.direction;overlay.innerHTML="";var alignments=Default.OutputElement.getInput().getAttribute("mstalign").split("|"),lines=Default.SourceElement.get().value.split("\n"),aligns=[];for(var k=0;k<alignments.length;k++){var ag=alignments[k].split(" ");for(var j=0;j<ag.length;j++)ag[j]=new Default.Utils.Alignment(ag[j]);function sortFun(p1,p2){return p1.SrcBegin>p2.SrcBegin||p1.SrcBegin==p2.SrcBegin&&p1.SrcEnd>p2.SrcEnd?1:p1.SrcBegin==p2.SrcBegin?0:-1}ag.sort(sortFun);for(var j=0;j<ag.length-1;j++)if(ag[j].SrcBegin==ag[j+1].SrcBegin){ag.splice(j+1,1);j--}aligns.push(ag)}for(var k=0,m=0;k<lines.length;k++){lines[k]=lines[k].replace("\r","");if(lines[k].trim().length==0)continue;var text=lines[k],regex=/^([ ]*)(.*)$/,match=regex.exec(text),inc=match[1].length,lastInd=match[1].length;for(var i=0;i<aligns[m].length;i++){aligns[m][i].SrcBegin+=inc;aligns[m][i].SrcEnd+=inc}for(var j=0;j<aligns[m].length;j++){inc=0;var srcBegin=aligns[m][j].SrcBegin,srcEnd=aligns[m][j].SrcEnd,wt=-1;for(var i=lastInd;i<=srcBegin;i++){if(text[i]==" ")wt++;if(text[i]!=" "||i==srcBegin){if(wt>0){inc+=wt;srcBegin+=wt}if(text[i]!=" ")wt=-1;else wt=0}}srcEnd+=inc;wt=-1;for(var i=srcBegin;i<=srcEnd;i++){if(text[i]==" ")wt++;if(text[i]!=" "||i==srcEnd){if(wt>0){inc+=wt;srcEnd+=wt}if(text[i]!=" ")wt=-1;else wt=0}}aligns[m][j].SrcBegin=srcBegin;aligns[m][j].SrcEnd=srcEnd;for(var i=j+1;i<aligns[m].length;i++){aligns[m][i].SrcBegin+=inc;aligns[m][i].SrcEnd+=inc}lastInd=aligns[m][j].SrcEnd+1}m++}for(var m=0,k=0;m<aligns.length;m++){while(lines[k].trim().length==0)k++;for(var i=0;i<aligns[m].length;i++){if(i+1>=aligns[m].length)break;if(aligns[m][i].DstBegin==aligns[m][i+1].DstBegin&&aligns[m][i].SrcEnd+1<=aligns[m][i+1].SrcBegin){aligns[m][i].SrcEnd=aligns[m][i+1].SrcEnd;aligns[m].splice(i+1,1);i--}else if(aligns[m][i].DstBegin==aligns[m][i+1].DstBegin&&aligns[m][i].SrcEnd+2==aligns[m][i+1].SrcBegin&&lines[k][aligns[m][i].SrcEnd+1]==" "){aligns[m][i].SrcEnd=aligns[m][i+1].SrcEnd;aligns[m].splice(i+1,1);i--}}}var noHightLightIds=0;for(var k=0,m=0;k<lines.length;k++){if(lines[k].trim().length==0){overlay.appendChild(document.createElement("br"));continue}var div=document.createElement("div"),lastInd=0;for(var j=0;j<aligns[m].length;j++){var node=document.createElement("span");if($.browser.msie&&$.browser.version<9)node.innerText=lines[k].substring(lastInd,aligns[m][j].SrcBegin);else $(node).text(lines[k].substring(lastInd,aligns[m][j].SrcBegin));$(node).attr("id","nohighlight["+noHightLightIds+"]");noHightLightIds++;div.appendChild(node);node=document.createElement("span");var tmp=lines[k].substring(aligns[m][j].SrcBegin,aligns[m][j].SrcEnd+1);if($.browser.msie&&$.browser.version<9)node.innerText=lines[k].substring(aligns[m][j].SrcBegin,aligns[m][j].SrcEnd+1);else $(node).text(lines[k].substring(aligns[m][j].SrcBegin,aligns[m][j].SrcEnd+1));if(tmp.length>1||Default.Constants.Separators[lang]&&Default.Constants.Separators[lang].indexOf(tmp)==-1||!Default.Constants.Separators[lang]&&Default.Constants.Separators["en"].indexOf(tmp)==-1){node.setAttribute("id","Src["+m+"]["+aligns[m][j].Src+":"+aligns[m][j].Dst+"]");node.setAttribute("_mstSrc",m+"_"+aligns[m][j].Src);node.setAttribute("_mstDst",m+"_"+aligns[m][j].Dst);node.setAttribute("onmouseover","Default.UI.PhraseHighlight(this)");node.setAttribute("onmouseout","Default.UI.ClearHighlight()")}else{$(node).attr("id","noHighlightId["+noHightLightIds+"]");noHightLightIds++}div.appendChild(node);lastInd=aligns[m][j].SrcEnd+1}if(lastInd<lines[k].length){var node=document.createElement("span");$(node).text(lines[k].substring(lastInd));div.appendChild(node)}overlay.appendChild(div);m++}setTimeout(Default.SourceElement.UpdateOverlayDimensions,200)},GetOverlayWidth:function(){var inputText=Default.SourceElement.get(),style;if(window.getComputedStyle)style=window.getComputedStyle(inputText);else style=inputText.currentStyle;if($.browser.msie&&$.browser.version<9)return inputText.offsetWidth-parseInt($(inputText).css("padding-right"));else if($.browser.mozilla){var diff=Math.ceil(parseFloat(style.getPropertyValue("width"))-parseInt(style.getPropertyValue("width")));return parseInt(style.getPropertyValue("width"))+parseInt(style.getPropertyValue("padding-right"))+diff+1}else return $(inputText).innerWidth()}};Default.SourceValue={get:function(){return Default.SourceElement.get().value},set:function(text){var e=Default.SourceElement.get();e.value=text}};WaitImage={Show:function(){Default.OutputElement.set_ClassName(Default.Constants.InvisibleClass);Default.Elements.get_AjaxWaitImage().style.visibility="visible"},ShowRTT:function(){Default.Elements.get_RTTLoading().style.visibility="visible"},Hide:function(){Default.OutputElement.set_ClassNormal();Default.Elements.get_AjaxWaitImage().style.visibility="hidden"},HideRTT:function(){Default.Elements.get_RTTLoading().style.visibility="hidden"}};Default.Utils={isExplorer:function(){return window.navigator.userAgent.toUpperCase().indexOf("MSIE")>-1},CollapseString:function(s){s=s.trimCr();s=s.replace(new RegExp(Default.Constants.OneOrMoreSpaces),"");return s},ValidateInput:function(){var s=Default.SourceValue.get();if(s.isEmpty())return false;if(!s.match(/[a-zA-Z\xC0-\uFFFF]/))return false;return true},GetBvUrl:function(url){with(Default)return Constants.BvUrl+"?"+Constants.BvLangFmParam+"="+Language.getFrom()+"&"+Constants.BvLangToParam+"="+Language.getTo()+"&"+Constants.BvTargetUrl+"="+url},FindPosition:function(obj){var curleft=0,curtop=0;if(obj&&obj.offsetParent)do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while(obj=obj.offsetParent);return {x:curleft,y:curtop}},ToggleClassName:function(elem,className){var flag=0;if(elem&&elem.className!==null&&elem.className!==undefined)if(elem.className.match(className)){elem.className=elem.className.replace(className,"");flag=-1}else{elem.className+=className;flag=1}return flag},AddClassName:function(elem,className){if(elem&&elem.className!==null&&elem.className!==undefined){var elemClassName=" "+elem.className.trim();className=" "+className.trim();if(!elemClassName.match(className)){elemClassName+=className;elem.className=elemClassName.trim()}return true}else return false},RemoveClassName:function(elem,className){if(elem&&elem.className!==null&&elem.className!==undefined){className=className.trim();var elemClassName=" "+elem.className.trim();elem.className=elemClassName.replace(className,"").trim();return true}else return false},SortTranslations:function(a,b){if(a.Rating<b.Rating)return 1;else if(a.Rating>b.Rating)return -1;else if(a.Count<b.Count)return 1;else if(a.Count>b.Count)return -1;else if(a.TranslatedText>b.TranslatedText)return 1;else if(a.TranslatedText<b.TranslatedText)return -1;else return 0},GetText:function(elem){var text="";if(elem)text=elem.innerText||elem.textContent||"";return text},SetText:function(elem,text){if(elem)if(elem.innerText!==undefined)elem.innerText=text;else elem.textContent=text},htmlEncode:function(value){var div=document.createElement("div");Default.Utils.SetText(div,value);return div.innerHTML},htmlEncodeKeepWS:function(value){return String(value).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},SendUrlTranslationViaPost:function(url){params=[];with(Default){params[Constants.BvLangFmParam]=Language.getFrom();params[Constants.BvLangToParam]=Language.getTo();params[Constants.BvTargetUrl]=url}Util.SendPostRequest(Default.Constants.BvUrl,params,"_blank")},Alignment:function(str){var tmp=str.split("-");this.Src=tmp[0];this.Dst=tmp[1];var src=tmp[0].split(":"),dst=tmp[1].split(":");this.DstBegin=parseInt(dst[0]);this.DstEnd=parseInt(dst[1]);this.SrcBegin=parseInt(src[0]);this.SrcEnd=parseInt(src[1])}};Default.UI={TimerId:null,SupressFocus:false,SupportedTTSLanguages:null,DisablePhraseAlignment:false,DictionaryEntry:false,SetVisibility:function(success){var isIE=Default.Utils.isExplorer(),visibility=success?"visible":"hidden";with(Default.Elements){get_SearchButton().style.visibility=visibility;get_EmailButton().style.visibility=visibility;get_TdTransRating().style.visibility=visibility;get_ClearLink().style.visibility=visibility;get_SpeakButton().style.visibility="hidden";if(success&&T2S.Enabled){var ttsLanguages=this.SupportedTTSLanguages.split(",");for(var i=0;i<ttsLanguages.length;i++)if(Default.Language.getTo()==ttsLanguages[i]){get_SpeakButton().style.visibility="visible";break}}if(LangPair.strFromLang.toLowerCase()=="tlh-qon"){$("#InputText").removeClass("mttextarea");$("#InputText").addClass("klingon")}else{$("#InputText").removeClass("klingon");$("#InputText").addClass("mttextarea")}if(LangPair.strToLang.toLowerCase()=="tlh-qon"){$("#TranslationOutput").removeClass("mttextarea");$("#TranslationOutput").addClass("klingon")}else{$("#TranslationOutput").removeClass("klingon");$("#TranslationOutput").addClass("mttextarea")}if(Default.Service.HasTransError){get_SpeakButton().style.visibility="hidden";get_SearchButton().style.visibility="hidden";get_EmailButton().style.visibility="hidden";get_ClearLink().style.visibility="hidden"}}},HideShowHmong:function(show){Default.Elements.get_HmongRow().style.display=show?"block":"none"},HideShowTilde:function(show){Default.Elements.get_TildeRow().style.display=show?"block":"none"},HideShowUrdu:function(show){Default.Elements.get_UrduRow().style.display=show?"block":"none"},HideShowKlingon:function(show){Default.Elements.get_KlingonRow().style.display=show?"block":"none"},SetDisabled:function(isDisabled){with(Default.Elements){get_SearchButton().removeAttribute("disabled");get_EmailButton().removeAttribute("disabled");get_SpeakButton().removeAttribute("disabled");get_TranslateButton().removeAttribute("disabled");if(isDisabled){get_SearchButton().setAttribute("disabled",true);get_EmailButton().setAttribute("disabled",true);get_SpeakButton().setAttribute("disabled",true);get_TranslateButton().setAttribute("disabled",true)}}},SetPreTransLayout:function(){Default.UI.SetDisabled(false);Default.UI.SetVisibility(false)},SetPostTransLayout:function(success){Default.UI.SetVisibility(success);Default.UI.SetTextDimensions();Default.UI.SetDisabled(false);Default.UI.ShowFBConfirm(false);if(success){Default.OutputElement.get().setAttribute("dir",Default.Language.getDirection(Default.Language.getTo()));Default.Elements.$mt("InputTextHtmlCell").setAttribute("dir",Default.Language.getDirection(Default.Language.getFrom(Default.Service.DetectedLang)));if(!Default.Globals.RTT)Default.UI.SetCursorToEnd()}},ClearAll:function(focus){Default.UI.DisableHightlight=true;Default.SourceElement.resetOverlay();this.SetPreTransLayout();Default.SourceValue.set("");Default.OutputValue.set("");Default.Elements.get_SearchClip().value="";this.SetTextDimensions();if(focus)this.SetCursorToEnd();Default.Elements.get_ClearLink().style.visibility="hidden";var srclink=Default.Elements.get_SrcLink();if(srclink)srclink.style.display="none";Default.Elements.get_SrcLinkPlaceHolder().style.display="";this.SupressFocus=false;if(T2S)T2S.SetNewTranslation()},LangChanged:function(){Default.Elements.$mt("InputTextHtmlCell").setAttribute("dir",Default.Language.getDirection(Default.Language.getFrom(Default.Service.DetectedLang)));Default.UI.HideShowTilde(Default.Language.getTo()=="lv"||Default.Language.getFrom()=="lv");Default.UI.HideShowHmong(Default.Language.getTo()=="mww"||Default.Language.getFrom()=="mww");Default.UI.HideShowUrdu(Default.Language.getTo()=="ur"||Default.Language.getFrom()=="ur");Default.UI.HideShowKlingon(Default.Language.getTo()=="tlh"||Default.Language.getFrom()=="tlh"||Default.Language.getTo()=="tlh-qon"||Default.Language.getFrom()=="tlh-qon")},TextInputFocus:function(){Default.Globals.EscapeKeyDouble=false;Default.Globals.EscapeKeyDown=false},TextInputKeyDown:function(e){with(Default){if(!e)e=window.event;if(e.keyCode==Constants.KeyCode.ShiftKey)Globals.ShiftKeyDown=true}},TextInputKeyUp:function(e){with(Default){if(!e)e=window.event;var code=e.keyCode||e.which,isSpecialKey=false;for(var key in Constants.NoHighlightKeys)if(code==Constants.NoHighlightKeys[key]){isSpecialKey=true;break}if(code==Constants.KeyCode.ReturnKey&&!Globals.ShiftKeyDown){if(Default.Globals.Initialized&&(UI.SourceHasChanged(true)||Default.Globals.RTT))Service.Translate()}else if(code==Constants.KeyCode.ShiftKey)Globals.ShiftKeyDown=false;else if(code==Constants.KeyCode.CtrlKey)Globals.CtrlKeyDown=false;else if(code==Constants.KeyCode.AltKey)Globals.AltKeyDown=false;else if(!isSpecialKey){Default.UI.SetTextDimensions();Default.UI.ClearHighlight()}}},SetTextDimensions:function(){with(Default.Elements){var displayHeight=186,inputElem=Default.SourceElement.get(),outputElem=Default.OutputElement.get();if(outputElem.offsetHeight&&outputElem.offsetHeight>displayHeight)displayHeight=outputElem.offsetHeight+3;inputElem.style.height=displayHeight+"px";if(inputElem.scrollHeight>inputElem.offsetHeight)inputElem.style.height=inputElem.scrollHeight+"px"}},SetCursorToEnd:function(){if(Default.UI.SupressFocus)return;var len=Default.SourceValue.get().length;if(Default.SourceElement.get().setSelectionRange){Default.SourceElement.get().focus();Default.SourceElement.get().setSelectionRange(len,len)}else if(Default.SourceElement.get().createTextRange){var range=Default.SourceElement.get().createTextRange();range.collapse(true);range.moveEnd("character",len,len);range.moveStart("character",len,len);range.select()}},SourceHasChanged:function(suppressUpdate){with(Default){if(Default.SourceValue.get().isEmpty())return false;var hasChange=false;if(Default.SourceValue.get().trim().length==0)hasChange=true;else{var str1=Utils.CollapseString(Default.SourceValue.get()),str2=Utils.CollapseString(Globals.PreviousText),lpChanged=Language.getFrom()!=Globals.PreviousFrom||Language.getTo()!=Globals.PreviousTo;hasChange=str1!=str2||lpChanged||this.LineCountChanged()}if(!suppressUpdate){Globals.PreviousText=Default.SourceValue.get();Globals.PreviousFrom=Language.getFrom();Globals.PreviousTo=Language.getTo()}return hasChange}},LineCountChanged:function(){var lineCount1=0,lineCount2=0,arry1=Default.SourceValue.get().split(Default.Constants.NewLine),arry2=Default.Globals.PreviousText.split(Default.Constants.NewLine),i;for(i=0;i<arry1.length;i++)if(arry1[i].isEmpty()==false)lineCount1++;for(i=0;i<arry2.length;i++)if(arry2[i].isEmpty()==false)lineCount2++;return lineCount1!=lineCount2},ShowFBConfirm:function(show){with(Default.Elements){get_RateRow1().style.display=show?"none":"block";get_RateRow2().style.display=show?"block":"none"}},PhraseHighlight:function(obj){Default.UI.ClearHighlight();var lang=LangPair_FromDDL.getValue();if(lang=="")lang=LangPair.elemFromLangLAD.value;if(!Default.Globals.PhraseAlignment||Default.UI.DisableHightlight||Default.UI.DictionaryEntry||Default.SourceElement.SourceLanguage!=lang)return;if(Default.Globals.PreviousText.trim()!=Default.SourceValue.get().trim())return;if(Default.Globals.PreviousText!=Default.SourceValue.get())Default.SourceElement.PopulateOverlay();var params=obj.getAttribute("_mstSrc").split("_"),divNum=params[0],src=params[1];params=obj.getAttribute("_mstDst").split("_");var dst=params[1];$(Default.SourceElement.getOverlay()).children("div").children("[_mstDst='"+divNum+"_"+dst+"']").addClass(Default.Constants.OverlayHighlightClass);$(Default.OutputElement.get()).children("div").children("[_mstDst='"+divNum+"_"+dst+"']").addClass(Default.Constants.OutputHighlightClass);$(Default.SourceElement.getOverlay()).children("div").children("[_mstSrc='"+divNum+"_"+src+"']").addClass(Default.Constants.OverlayHighlightClass);$(Default.OutputElement.get()).children("div").children("[_mstSrc='"+divNum+"_"+src+"']").addClass(Default.Constants.OutputHighlightClass);Default.SourceElement.getOverlay().style.visibility="visible"},ClearHighlight:function(){if(!Default.Globals.PhraseAlignment)return;$(Default.SourceElement.getOverlay()).children("div").children("."+Default.Constants.OverlayHighlightClass).removeClass(Default.Constants.OverlayHighlightClass);$(Default.OutputElement.get()).children("div").children("."+Default.Constants.OutputHighlightClass).removeClass(Default.Constants.OutputHighlightClass);Default.SourceElement.getOverlay().style.visibility="hidden"},IsMobileDevice:function(){var userAgent=navigator.userAgent||navigator.vendor||window.opera;return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(userAgent.substr(0,4))}};Default.Init=function(){Default.Elements.Init();LangPair.Init();LangPair.OnChangeHandlerMethod=Default.UI.LangChanged;var eRewardsLink=document.getElementById("sw_meCtrl");if(eRewardsLink&&eRewardsLink.href)eRewardsLink.href=eRewardsLink.href.replace("microsofttranslator.com","bing.com").replace("microsofttranslator-int.com","bing-int.com");Default.Globals.Initialized=true};Default.Service={DictText:"",Success:false,LangTo:null,LangFrom:null,TimeoutId:"",HasTransError:false,TransComplete:false,Dictionary:{IsActive:false,SupportedLP:"",MaxWords:4,MaxOverride:"",Translation:"",ExceedsMax:function(from,txt){var max=Default.Service.Dictionary.MaxWords,override=Default.Service.Dictionary.MaxOverride.split(",");for(var i=0;i<override.length;i++){var pair=override[i].split(":");if(pair.length==2){var lang=pair[0],len=parseInt(pair[1]);if(from.toLowerCase()==lang.toLowerCase()){max=len;break}}}if(txt.length>32||txt.split(/\s+/).length>max)return true;else return false},SupportsLangPair:function(from,to){var languages=Default.Service.Dictionary.SupportedLP.split(","),supported=false;if(from.indexOf("-")!=-1)from=from.substr(0,from.indexOf("-"));if(to.indexOf("-")!=-1)to=to.substr(0,to.indexOf("-"));var lp=from+"-"+to;for(var i=0;i<languages.length;i++)if(lp.toLowerCase()==languages[i].toLowerCase()){supported=true;break}return supported},TryOutputResults:function(){if(Default.Service.TransComplete)if(Default.Service.Dictionary.FromLang==LangPair.strFromLang||Default.Service.Dictionary.FromLang==LangPair.strFromLangADL){if(Default.Service.Dictionary.Translation.length>0){var s=Default.Service.Dictionary.Translation.split("{0}");if(s.length==2){Default.OutputValue.pre(s[0],"_outputHeader");Default.OutputValue.add(s[1],"_dictContent");Default.UI.SetTextDimensions()}return true}}else if(LangPair.strFromLangADL)Default.Service.CallDictionary();return false}},DetectedLang:"en",HandleError:function(){Default.UI.SetPostTransLayout(false);Default.Elements.get_ClearLink().style.visibility="visible";Default.UI.SetTextDimensions()},CheckForUrl:function(text){var url=text.trimCr();if(url.match(/\s/))return false;if(url.match(/[:][\/][\/]/)){if(url.length<200)document.location=Default.Utils.GetBvUrl(url);else Default.Utils.SendUrlTranslationViaPost(url);return true}var domainMatch=url.match(/^[\w\-]+(\.[\w\-]+)*\.[a-zA-Z]{2,}(\/.*)?\s{0,}$/);if(domainMatch){if(url.length<200)document.location=Default.Utils.GetBvUrl(url);else Default.Utils.SendUrlTranslationViaPost(url);return true}return false},checkForUrlWithoutRedirect:function(text){var url=text.trimCr();if(url.match(/\s/))return false;if(url.match(/[:][\/][\/]/))return true;var domainMatch=url.match(/^[\w\-]+(\.[\w\-]+)*\.[a-zA-Z]{2,}(\/.*)?\s{0,}$/);if(domainMatch)return true;return false},ErrorHandler:function(){alert("an error occurred.")},CallDictionary:function(){try{Default.Service.Dictionary.FromLang=LangPair.strFromLang||Default.Service.DetectedLang||LangPair.strFromLangADL;if(Default.Service.Dictionary.IsActive){var detectedLang="";if(null!=Default.Service.DetectedLang)detectedLang=Default.Service.DetectedLang;var srcText=Default.SourceValue.get().trimCr(),from=Default.Language.getFrom(detectedLang),to=Default.Language.getTo();if(false==Default.Service.Dictionary.ExceedsMax(from,srcText))if(Default.Service.Dictionary.SupportsLangPair(from,to)){var dictScript=document.createElement("script");dictScript.src=Default.Service.Dictionary.BaseUrl+"?from="+from+"&to="+to+"&text="+encodeURIComponent(srcText)+"&oncomplete=onDictComplete";document.body.appendChild(dictScript)}}}catch(e){}},OutputResults:function(){if(Default.OutputValue.get().trim().length==0)Default.Service.HasTransError=true;if(Default.Service.HasTransError){Default.Service.TransComplete=true;Default.UI.SetPostTransLayout(false);return}Default.Service.DetectedLang=Default.Language.getFrom("");if(Default.Service.DetectedLang.length==0)if(undefined!=Default.Service.MSTranslator.detectedLanguage&&null!=Default.Service.MSTranslator.detectedLanguage)Default.Service.DetectedLang=Default.Service.MSTranslator.detectedLanguage;Default.Service.SetLangCodes();if(LangPair.strFromLang==""&&Default.Service.DetectedLang.length>0&&Default.Constants.LangNames[Default.Service.DetectedLang]){LangPair.autoSet=true;LangPair.SetAutoDetectLanguage(Default.Elements.get_AutoDetectPat().value.replace("{0}",Default.Constants.LangNames[Default.Service.DetectedLang]),Default.Service.DetectedLang);if(Default.Service.DetectedLang==LangPair.strToLang&&LangPair.mrulToLangs)for(var mrul=0;mrul<LangPair.mrulToLangs.length;mrul++)if(LangPair.mrulToLangs[mrul]!=Default.Service.DetectedLang){Default.Language.setTo(LangPair.mrulToLangs[mrul]);Default.Service.Translate();return}}Default.Utils.SetText(Default.Elements.get_SearchClip(),Default.Utils.GetText(Default.OutputElement.get()));Default.Service.TransComplete=true;Default.OutputValue.sync();var searchQuery=encodeURIComponent(Default.OutputValue.get().replace(/\s+/g," ")).replace(/%20/g,"+");if(searchQuery.length>1950)searchQuery=searchQuery.substr(0,searchQuery.indexOf("%",1950));Default.Elements.get_SearchButton().href=Default.Constants.SearchBaseUrl+searchQuery;var emailText=Default.OutputValue.emailText(),emailBtnElem=Default.Elements.get_EmailButton();if(emailText){emailBtnElem.href=Default.Constants.EmailBaseUrl+emailText;emailBtnElem.style.display=""}else emailBtnElem.style.display="none";Default.UI.SetPostTransLayout(true);Default.Service.Dictionary.TryOutputResults()},FixReturns:function(s){var fix=s.replace(new RegExp("^[\r\n]{1,}","gi"),"");fix=fix.replace(new RegExp("[\r\n]{2,}$","gi"),"\r\n");return fix.replace(new RegExp("[\r\n]{3,}","gi"),"\r\n\r\n")},SetLangCodes:function(){return Default.Constants.LangNames},SetDictionaryResult:function(dictTrans){Default.Service.Dictionary.Translation="";if(null==dictTrans||dictTrans.trim().length==0)return;var tranTitle='<div class="TranslationHeader">'+Default.Elements.get_TranslationTitle().value+"</div>",dictTitle='<div class="DictionaryHeader">'+Default.Elements.get_DictionaryTitle().value+"</div>";Default.Service.Dictionary.Translation=tranTitle+"{0}"+dictTitle+dictTrans;Default.Service.Dictionary.TryOutputResults();Default.UI.DictionaryEntry=true},MSTranslator:null,GetTranslation:function(){try{Default.UI.DisableHightlight=true;Default.UI.DictionaryEntry=false;if(!Default.Globals.RTT)WaitImage.Show();var txt=Default.SourceValue.get();txt=txt.replace(/^[\n\r]+/g,"");if(txt.length>Default.Constants.MaxTransChars)txt=txt.substr(0,Default.Constants.MaxTransChars);Default.OutputValue.setInput(txt);if(Default.Service.MSTranslator&&Default.Service.MSTranslator.cancel)try{Default.Service.MSTranslator.cancel()}catch(e){}Default.Service.MSTranslator=Microsoft.Translator.Translate(Default.Constants.AjaxApiAppId,Default.OutputElement.getInput(),Default.Language.getFrom(""),Default.Language.getTo(),function(){WaitImage.Hide();Default.Service.OutputResults();WaitImage.HideRTT()},function(){},14000);Default.Service.MSTranslator.showTooltips=false;Default.Service.MSTranslator.showHighlight=false;Default.Service.CallDictionary()}catch(e){}},GetTranslationRTT:function(){try{if(!Default.Globals.RTT)WaitImage.Show();Default.SourceElement.resetOverlay();var txt=Default.SourceValue.get();txt=txt.replace(/^[\n\r]+/g,"");if(txt.length>Default.Constants.MaxTransChars)txt=txt.substr(0,Default.Constants.MaxTransChars);Default.OutputValue.setInput(txt);Default.Service.MSTranslator=Microsoft.Translator.Translate(Default.Constants.RTTAppID,Default.OutputElement.getInput(),Default.Language.getFrom(""),Default.Language.getTo(),function(){Default.Globals.RTTCallIteration=1;Default.Service.OutputResults();WaitImage.HideRTT()},function(){},14000);Default.Service.MSTranslator.showTooltips=false;Default.Service.MSTranslator.showHighlight=false;Default.Service.CallDictionary()}catch(e){}},Translate:function(suppressRedirect){if(Default.Globals.Initialized==false){setTimeout(function(){Default.Service.Translate(suppressRedirect)},50);return}T2S.SetNewTranslation();Default.Service.HasTransError=false;Default.Service.TransComplete=false;Default.Service.Dictionary.Translation="";Default.SourceElement.resetOverlay();if(!Default.Globals.RTT&&!LangPair.strFromLang)LangPair.SetAutoDetectLanguage(Default.Elements.get_AutoDetectTxt().value,"");T2S.SetPreTrans();with(Default){if(!Utils.ValidateInput())return;try{if(!suppressRedirect&&Service.CheckForUrl(SourceValue.get()))return;if(Default.Globals.RTT){Globals.PreviousText=Default.SourceValue.get();Globals.PreviousFrom=Language.getFrom();Globals.PreviousTo=Language.getTo()}if(suppressRedirect===0)WaitImage.Show();Service.GetTranslation()}catch(error){UI.SetDisabled(false);UI.SetPostTransLayout(false);if(!Default.Globals.RTT)WaitImage.Hide();alert(error.description)}}},TranslateRTT:function(forceTranslation){Default.Service.HasTransError=false;Default.Service.TransComplete=false;Default.Service.Dictionary.Translation="";if(!Default.Globals.RTT&&!LangPair.strFromLang)LangPair.SetAutoDetectLanguage(Default.Elements.get_AutoDetectTxt().value,"");WaitImage.Hide();with(Default){if(!Utils.ValidateInput()){Globals.PreviousTextRTT="";Default.OutputElement.get().innerHTML="";Default.UI.SetTextDimensions();return}try{var prevFromLang=Globals.PreviousFrom,prevToLang=Globals.PreviousTo;Globals.PreviousFrom=Language.getFrom();Globals.PreviousTo=Language.getTo();if(Default.SourceValue.get().trim()!=Globals.PreviousTextRTT.trim()||prevFromLang!=Globals.PreviousFrom||prevToLang!=Globals.PreviousTo||forceTranslation){WaitImage.ShowRTT();Globals.PreviousTextRTT=Default.SourceValue.get();if(Service.checkForUrlWithoutRedirect(SourceValue.get())){Default.OutputValue.addHyperLink(SourceValue.get());Default.OutputValue.hideOptions();WaitImage.HideRTT();return}if(Default.Globals.RTTCallIteration%2!=0)if(Default.Service.MSTranslator&&Default.Service.MSTranslator.cancel){try{Default.Service.MSTranslator.cancel()}catch(e){}Default.Globals.RTTCallIteration++}Service.GetTranslationRTT()}}catch(error){UI.SetDisabled(false);UI.SetPostTransLayout(false);if(!Default.Globals.RTT)WaitImage.Hide();console.log(error)}}},DictonaryComplete:function(e){if(e){Default.Service.DictText=e;if(Default.OutputValue.get().trim().length>0&&e.length>0)Default.Service.OutputResults()}}};Default.Rating={SubmitRating:function(iRating){Default.UI.ShowFBConfirm(true);try{var oText=Default.SourceValue.get(),tText=Default.OutputValue.get(),fromLang=Default.Language.getFrom()||LangPair.strFromLangADL,toLang=Default.Language.getTo();Microsoft.Translator.AddTranslation(Default.Constants.AjaxApiAppId,oText,tText,fromLang,toLang,iRating,null,null,Default.Globals.AjaxApiUserId)}catch(e){}},SubmitSentanceRating:function(iRating,iText,tText){try{var fromLang=Default.Language.getFrom()||LangPair.strFromLangADL,toLang=Default.Language.getTo();Microsoft.Translator.AddTranslation(Default.Constants.CTFApiAppId,iText,tText,fromLang,toLang,iRating,null,null,Default.Globals.AjaxApiUserId)}catch(e){}}};window.onDictComplete=function(dict){Default.Service.SetDictionaryResult(dict)};function Initialize(){Default.Constants.PlayText=Default.Elements.get_PlayText().value;window.onresize=document.body.onresize=function(){setTimeout(Default.UI.SetTextDimensions,200);setTimeout(Default.SourceElement.UpdateOverlayDimensions,300)};Default.SourceElement.get().onpaste=function(){Default.UI.ClearHighlight();setTimeout(Default.UI.SetTextDimensions,200);setTimeout(Default.SourceElement.UpdateOverlayDimensions,300)};if(Default.Globals.PhraseAlignment)if(!Default.UI.IsMobileDevice()){$(Default.SourceElement.get()).mousemove(function(e){$(Default.SourceElement.getOverlay()).css("z-index","1");$(Default.SourceElement.getOverlay()).css("visibility","visible");var element=document.elementFromPoint(e.clientX,e.clientY),ev=jQuery.Event("mouseover");ev.clientX=e.clientX;ev.clientY=e.clientY;Default.UI.ClearHighlight();$(Default.SourceElement.getOverlay()).css("z-index","-1");$(element).trigger(ev)});$(Default.SourceElement.get()).mouseout(function(){Default.UI.ClearHighlight()})}var eTransUrlLink=document.getElementById("TransUrlLink");if(eTransUrlLink&&eTransUrlLink.innerHTML){var eUrlTransCell=document.getElementById("urlTransCell");if(eUrlTransCell)eTransUrlLink.innerHTML=eTransUrlLink.innerHTML.replace(/./g,function(m){return m+"&#8203;"})}Default.SourceElement.get().removeAttribute("disabled");Default.OutputElement.get().removeAttribute("disabled");Default.SourceElement.get().focus();if(Default.SourceValue.get()&&!Default.Globals.RTT)Default.Service.Translate(true);if(Default.Globals.RTT)setInterval(function(){Default.Service.TranslateRTT(false)},1200)}function CDefaultPrev(){return this}CDefaultPrev.prototype.Init=function(){this.eTranslationOutput=document.getElementById("DictionaryOutput");this.eMoreLink=document.getElementById("MoreLink");this.eTranslatedText=document.getElementById("TranslatedText");if(this.eTranslationOutput==null){this.eMoreLink.style.display="none";return}var h=this.eTranslationOutput.clientHeight;this.eMoreLink.style.display=parseInt(this.eTranslationOutput.scrollHeight)>h?"":"none";var eDetectLangTxt=document.getElementById("DetectLangTxt"),eDetectLangVal=document.getElementById("DetectLangVal");if(eDetectLangTxt&&eDetectLangVal){var sDetectLangTxt=eDetectLangTxt.innerText||eDetectLangTxt.textContent,sDetectLangVal=eDetectLangVal.innerText||eDetectLangVal.textContent;if(sDetectLangTxt&&sDetectLangVal)LangPairPrev.SetAutoDetectLanguage(sDetectLangTxt,sDetectLangVal)}};CDefaultPrev.prototype.SubmitToDefault=function(){var form=null;for(var i=0;i<document.forms.length;i++)if(document.forms[i].name=="MainForm"){form=document.forms[i];break}if(form==null)form=document.forms[0];form.action="default.aspx";form.target="_blank";form.method="Post";form.submit()};DefaultPrev=new CDefaultPrev;var MtPopUpList=function(){this.onChanged=null;this.shiftKeyDown=false;this.MRUL=[];this.MAX_MRUL=2};MtPopUpList.prototype={keysBuffer:"",Init:function(name,keys,values,onChanged,popupid){this.Items=[];this.Keys=[];this.KeyMap=" "+keys.join(" ")+" ";this.keysBuffer="";var x=0;for(var i=0;i<keys.length;i++){this.Items[keys[i]]=values[i];if(keys[i]!="-"){this.Keys[x]=keys[i];x++}}this.onChanged=onChanged;document.onclick=this.HideCurrentPopup;this.elemHeader=Util.GetElement("__"+name+"_header");this.elemSvID=Util.GetElement(name+"_svid");this.elemTextId=Util.GetElement(name+"_textid");this.elemPopup=document.getElementById(popupid);this.cropText();if(this.elemPopup!=null){this.elemPopup.onkeydown=(new this.doKeyDown(this,this.HideCurrentPopup)).execute;this.elemPopup.onkeyup=(new this.doKeyUp(this)).execute;this.elemPopup.onkeypress=(new this.doKeyPress(this)).execute}this.name=name;this.mrul_cookie=name+"_lpmru";var list=Util.GetCookie(this.mrul_cookie);if(list!=null&&list!="undefined")this.MRUL=list.split(",");else this.MRUL=[]},getLinks:function(){return this.elemPopup.getElementsByTagName("a")},getActiveLink:function(){var links=this.getLinks(),key=this.elemSvID.value;if(key!=null)for(var i=0;i<links.length;i++)if(links[i].href.indexOf("#"+key)!=-1)return links[i];return links[0]},getByLetter:function(obj,keyCode,objLinks){var key=String.fromCharCode(keyCode).toUpperCase(),curLink=this.getActiveLink(),links=[],x;for(x=0;x<objLinks.length;x++)links[x]=objLinks[x];links.sort(function(a,b){var txtA=a.innerText||a.textContent,txtB=b.innerText||b.textContent;if(txtA<txtB)return -1;if(txtA>txtB)return 1;return 0});var i=0;for(;i<links.length;i++)if(curLink==links[i]){i++;break}for(;i<links.length;i++)if(this.getFirstChar(links[i])==key)return this.getHref(links[i]);for(x=0;x<links.length;x++)if(this.getFirstChar(links[x])==key&&curLink!=links[x])return this.getHref(links[x]);return null},getFirstChar:function(e){var x=e.innerText||e.textContent;if(x!=undefined&&x!=null&&x.length>0)return x.substr(0,1).toUpperCase();else return ""},getNextKey:function(s,offset){var idx=0;for(var i=0;i<this.Keys.length;i++)if(this.Keys[i]==s){idx=i;break}idx=idx+offset;if(idx>this.Keys.length)idx=0;else if(idx<0)idx=this.Keys.length-1;return this.Keys[idx]},getNextSibling:function(s,offset){var curLink=this.getActiveLink(),p=curLink.parentNode;while(p.tagName.toLowerCase()!="tr"&&p.parentNode!=null)p=p.parentNode;var sibs=p.getElementsByTagName("a"),idx=0;for(var i=0;i<sibs.length;i++)if(curLink.href==sibs[i].href){idx=i;break}idx=idx+offset;if(idx<0)idx=0;else if(idx>=sibs.length)idx=sibs.length-1;return this.getHref(sibs[idx])},doKeyUp:function(obj){this.execute=function(evt){if(!evt)evt=window.event;if(evt.keyCode==16){obj.shiftKeyDown=false;if(evt.preventDefault)evt.preventDefault();else evt.returnValue=false;evt.cancelBubble=true;return true}else return false}},doKeyPress:function(obj){this.execute=function(evt){if(!evt)evt=window.event;obj.keysBuffer+=String.fromCharCode(evt.charCode||evt.keyCode).toLowerCase();clearTimeout(obj.keyTimeOut);obj.keyTimeOut=setTimeout(function(){obj.keysBuffer=""},1000)}},doKeyDown:function(obj,fnHide){this.execute=function(evt){var nextKey=null;if(!evt)evt=window.event;var links=obj.getLinks(),s=obj.elemSvID.value,isChar=false;switch(evt.keyCode){case 16:obj.shiftKeyDown=true;return false;case 9:if(obj.shiftKeyDown)nextKey=obj.getNextKey(s,-1);else nextKey=obj.getNextKey(s,1);break;case 40:nextKey=obj.getNextKey(s,1);break;case 38:nextKey=obj.getNextKey(s,-1);break;case 39:nextKey=obj.getNextSibling(s,1);break;case 37:nextKey=obj.getNextSibling(s,-1);break;case 13:case 27:fnHide();return false;default:isChar=true}if(!isChar){var nLink=links[0];for(var i=0;i<links.length;i++)if(links[i].href.indexOf("#"+nextKey)!=-1){nLink=links[i];break}try{nLink.focus();nLink.onclick()}catch(e){}return false}else{window.evt=evt;setTimeout(function(){if(!evt)evt=window.evt;var links=obj.getLinks(),nLink;for(var i=0;i<links.length;i++){var lnkText=links[i].outerText||links[i].text;if(lnkText.toLowerCase().indexOf(obj.keysBuffer)==0&&lnkText!=(obj.getActiveLink().outerText||obj.getActiveLink().text)){nLink=links[i];break}}try{if(nLink){nLink.focus();nLink.onclick()}}catch(e){}},30)}return true}},Hide:function(){this.HideCurrentPopup()},Show:function(targetObjectId,evt){if(evt){if(evt.keyCode==27){this.Hide(targetObjectId,evt);return true}if(evt.keyCode&&evt.keyCode!=40)return false;if(window.curDisplayedPopup==targetObjectId){this.HideCurrentPopup();return true}this.HideCurrentPopup();evt.cancelBubble=true;if(this.ChangeObjectDisplay(targetObjectId,"block")){window.curDisplayedDDHeader=this.elemHeader;window.curDisplayedPopup=targetObjectId;this.getActiveLink().focus();Util.addClass(this.elemHeader,"DDSActive");return true}}return false},cropText:function(){var ellipse="...",text=this.elemHeader.innerHTML;this.elemHeader.title=text;this.elemHeader.innerHTML+="____";this.elemHeader.style["overflow"]="hidden";var clientWidth=this.elemHeader.clientWidth,scrollWidth=this.elemHeader.scrollWidth,widthRatio=clientWidth*1/scrollWidth*1;if(widthRatio<1){var newLength=Math.ceil(widthRatio*text.length);if(newLength<text.length)text=String(text).substring(0,newLength-ellipse.length)+ellipse}this.elemHeader.style["overflow"]="visible";this.elemHeader.innerHTML=text},getHref:function(link){return link.href.substr(link.href.indexOf("#")+1)},setValue:function(s,suppressEvent){if(s){var sm=(new RegExp(" ("+s+") ","i")).exec(this.KeyMap);if(sm&&sm[1])s=sm[1]}if(this.Items[s]==null)throw new Error("Value is not in the current list.");this.elemSvID.value=s;this.elemHeader.value=this.Items[s];if(suppressEvent!="true")this.addMRUL(s);var p=document.getElementById(this.name);if(p.tagName=="SELECT")for(var i=0;i<p.options.length;i++){var opt=p.options[i];if(opt.value==s){opt.selected="selected";break}}this.setText(this.Items[s],suppressEvent)},getValue:function(){return this.elemSvID.value},setText:function(s,suppressEvent){var p=document.getElementById(this.name);if(p.tagName.toLowerCase()=="select")if(p.value=="")p.options[0].text=s;else if(p.options[0].value=="")p.options[0].text=this.Items[""];this.elemTextId.value=s;this.elemHeader.innerHTML=s;this.cropText();if(suppressEvent!="true")this.onChanged(s,this.Items[s])},getText:function(){return this.elemTextId.value},onclick:function(val){this.setValue(val);return false},ondragstart:function(e){if(!e)e=window.event;if(e.preventDefault)e.preventDefault()},OnSelectedValueChanged:function(){return this.onChanged},HideCurrentPopup:function(){if(window.curDisplayedPopup){Util.GetElement(window.curDisplayedPopup).style.display="none";Util.removeClass(window.curDisplayedDDHeader,"DDSActive");window.curDisplayedPopup=false;window.curDisplayedDDHeader=null}this.shiftKeyDown=false},ChangeObjectDisplay:function(objectId,newDisplay){var styleObject=Util.GetStyleObject(objectId);if(styleObject&&styleObject.display){styleObject.display=newDisplay;return true}else return false},addMRUL:function(val){if(!val)return;if(this.MRUL[0]==val)return;var dup=0,i;for(i=1;i<this.MRUL.length;i++)if(this.MRUL[i]==val){dup=i;break}if(dup==0)this.MRUL.unshift(val);else{var dupVal=dup>0?this.MRUL[dup]:val;for(i=dup;i>0;i--)this.MRUL[i]=this.MRUL[i-1];this.MRUL[0]=dupVal}while(this.MRUL.length>this.MAX_MRUL)this.MRUL.pop();Util.SetCookie(this.mrul_cookie,this.MRUL,true,Util.GetPath())}};var MtPopUpListPrev=function(){this.onChanged=null;this.shiftKeyDown=false;this.MRUL=[];this.MAX_MRUL=3;this.cur_page=0};MtPopUpListPrev.prototype={Init:function(name,keys,values,onChanged,popupid){this.Items=[];this.Keys=[];var x=0;for(var i=0;i<keys.length;i++){this.Items[keys[i]]=values[i];if(keys[i]!="-"){this.Keys[x]=keys[i];x++}}this.onChanged=onChanged;document.onclick=this.HideCurrentPopup;this.elemHeader=Util.GetElement("__"+name+"_header");this.elemSvID=Util.GetElement(name+"_svid");this.elemTextId=Util.GetElement(name+"_textid");this.elemPopup=document.getElementById(popupid);this.elemTable=Util.GetElement(name);this.cropText();this.elemPopup.onkeydown=(new this.doKeyDown(this,this.HideCurrentPopup)).execute;this.elemPopup.onkeyup=(new this.doKeyUp(this)).execute;this.name=name;this.mrul_cookie=name+"_mruls";var list=Util.GetCookie(this.mrul_cookie);if(list!=null)this.MRUL=list.split(",");this.next_btn_id=name+"_next";this.prev_btn_id=name+"_prev";this.IsRtl=document.getElementById("LangPair_SwapImg").dir=="rtl"},getLinks:function(){return this.elemPopup.getElementsByTagName("a")},getActiveLink:function(fromMRUL){var links=this.getLinks(),key=this.elemSvID.value,i;if(key!=null&&key!=""){if(fromMRUL){var mkey="_"+key;for(i=0;i<links.length;i++)if(links[i].href.indexOf("#"+mkey)!=-1)return links[i];return null}for(i=0;i<links.length;i++)if(links[i].href.indexOf("#"+key)!=-1)return links[i]}return links[0]},getByLetter:function(obj,keyCode,objLinks){var key=String.fromCharCode(keyCode).toUpperCase(),curLink=this.getActiveLink(),x,links=[];for(x=0;x<objLinks.length;x++)links[x]=objLinks[x];links.sort(function(a,b){var txtA=a.innerText||a.textContent,txtB=b.innerText||b.textContent;if(txtA<txtB)return -1;if(txtA>txtB)return 1;return 0});var i=0;for(;i<links.length;i++)if(curLink==links[i]){i++;break}for(;i<links.length;i++)if(this.getFirstChar(links[i])==key)return this.getHref(links[i]);for(x=0;x<links.length;x++)if(this.getFirstChar(links[x])==key&&curLink!=links[x])return this.getHref(links[x]);return null},getFirstChar:function(e){var x=e.innerText||e.textContent;if(x!=undefined&&x!=null&&x.length>0)return x.substr(0,1).toUpperCase();else return ""},getNextKey:function(s,offset){var idx=0;for(var i=0;i<this.Keys.length;i++)if(this.Keys[i]==s){idx=i;break}idx=idx+offset;if(idx>this.Keys.length)idx=0;else if(idx<0)idx=this.Keys.length-1;return this.Keys[idx]},getNextSibling:function(s,offset){var curLink=this.getActiveLink(),p=curLink.parentNode;while(p.tagName.toLowerCase()!="tr"&&p.parentNode!=null)p=p.parentNode;var sibs=p.getElementsByTagName("a"),idx=0;for(var i=0;i<sibs.length;i++)if(curLink.href==sibs[i].href){idx=i;break}idx=idx+offset;if(idx<0)idx=0;else if(idx>=sibs.length)idx=sibs.length-1;return this.getHref(sibs[idx])},doKeyUp:function(obj){this.execute=function(evt){if(!evt)evt=window.event;if(evt.keyCode==16){obj.shiftKeyDown=false;if(evt.preventDefault)evt.preventDefault();else evt.returnValue=false;evt.cancelBubble=true;return true}else return false}},doKeyDown:function(obj,fnHide){this.execute=function(evt){if(!evt)evt=window.event;var links=obj.getLinks(),s=obj.elemSvID.value,nextKey=obj.getByLetter(obj,evt.keyCode,links);if(nextKey==null)switch(evt.keyCode){case 16:obj.shiftKeyDown=true;return false;break;case 9:if(obj.shiftKeyDown)nextKey=obj.getNextKey(s,-1);else nextKey=obj.getNextKey(s,1);break;case 40:nextKey=obj.getNextKey(s,1);break;case 38:nextKey=obj.getNextKey(s,-1);break;case 39:nextKey=obj.getNextSibling(s,1);break;case 37:nextKey=obj.getNextSibling(s,-1);break;case 13:case 27:fnHide();default:return false}var nLink=links[0];for(var i=0;i<links.length;i++)if(links[i].href.indexOf("#"+nextKey)!=-1){nLink=links[i];break}try{nLink.focus();nLink.onclick()}catch(e){}if(evt.preventDefault)evt.preventDefault();else evt.returnValue=false;evt.cancelBubble=true;return true}},Hide:function(targetObjectId,eventObj){this.HideCurrentPopup()},Show:function(targetObjectId,evt){if(evt){if(evt.keyCode==27){this.Hide(targetObjectId,evt);return true}if(evt.keyCode&&evt.keyCode!=40)return false;if(window.curDisplayedPopup==targetObjectId){this.HideCurrentPopup();return true}this.HideCurrentPopup();evt.cancelBubble=true;if(this.ChangeObjectDisplay(targetObjectId,"block")){window.curDisplayedPopup=targetObjectId;var link=this.getActiveLink(true);if(link)link.focus();this.ResetPage();return true}}return false},cropText:function(){var ellipse="...",text=this.elemHeader.innerHTML;this.elemHeader.title=text;this.elemHeader.innerHTML+="____";this.elemHeader.style["overflow"]="hidden";var clientWidth=this.elemHeader.clientWidth,scrollWidth=this.elemHeader.scrollWidth,widthRatio=clientWidth*1/scrollWidth*1;if(widthRatio<1){var newLength=Math.ceil(widthRatio*text.length);if(newLength<text.length)text=String(text).substring(0,newLength-ellipse.length)+ellipse}this.elemHeader.style["overflow"]="visible";this.elemHeader.innerHTML=text},getHref:function(link){return link.href.substr(link.href.indexOf("#")+1)},setValue:function(s,suppressEvent){if(this.Items[s]==null)throw new Error("Value is not in the current list.");this.elemSvID.value=s;this.elemHeader.value=this.Items[s];if(suppressEvent!="true")this.addMRUL(s);this.setText(this.Items[s],suppressEvent)},getValue:function(){return this.elemSvID.value},setText:function(s,suppressEvent){this.elemTextId.value=s;this.elemHeader.innerHTML=s;this.cropText();if(suppressEvent!="true")this.onChanged(s,this.Items[s])},getText:function(){return this.elemTextId.value},onclick:function(val){this.setValue(val);return false},ondragstart:function(e){if(!e)e=window.event;if(e.preventDefault)e.preventDefault()},OnSelectedValueChanged:function(){return this.onChanged},HideCurrentPopup:function(){if(window.curDisplayedPopup){Util.GetElement(window.curDisplayedPopup).style.display="none";window.curDisplayedPopup=false}this.shiftKeyDown=false},ChangeObjectDisplay:function(objectId,newDisplay){var styleObject=Util.GetStyleObject(objectId);if(styleObject&&styleObject.display){styleObject.display=newDisplay;return true}else return false},hasAutoDetect:function(){return this.Keys[0]==""},addMRUL:function(val){if(!val)return;val=val[0]=="_"?val.substring(1):val;if(this.MRUL[0]==val)return;var dup=0,min=this.hasAutoDetect()?1:0,temp="",i;for(i=1;i<this.MRUL.length;i++)if(this.MRUL[i]==val){dup=i;break}if(dup==0){if(!this.hasAutoDetect()&&this.MRUL.length==0)this.InsertCell("-","-",this.hasAutoDetect());this.InsertCell(val,this.Items[val],this.hasAutoDetect());this.MRUL.unshift(val)}else{var dupVal=dup>0?this.MRUL[dup]:val,rows=this.elemTable.tBodies[0].rows;for(i=dup;i>0;i--){this.MRUL[i]=this.MRUL[i-1];temp=rows[i+min].cells[0].innerHTML;rows[i+min].cells[0].innerHTML=rows[i+min-1].cells[0].innerHTML;rows[i+min-1].cells[0].innerHTML=temp}this.MRUL[0]=dupVal}while(this.MRUL.length>this.MAX_MRUL)this.MRUL.pop();Util.SetCookie(this.mrul_cookie,this.MRUL,true)},InsertCell:function(key,value,autodetect){var rows=this.elemTable.tBodies[0].rows,newCell="",i,j;if(key=="-")newCell="<hr />";else newCell='<a tabindex="-1" '+'onclick="return '+this.name+".onclick('"+key+"');\" "+'ondragstart="'+this.name+'.ondragstart(event);" '+'href="#_'+key+'">'+value+"</a>";var temp="",min=autodetect?1:0;if(this.MRUL.length<this.MAX_MRUL){var completeCells=true;for(i=0;i<rows[0].cells.length;i++)if(rows[rows.length-1].cells[i].innerHTML==""){completeCells=false;break}if(completeCells)for(i=0;i<rows.length;i++)rows[i].insertCell(-1);for(i=0;i<rows[0].cells.length;i++){for(j=min;j<rows.length;j++){min=0;if(newCell==""){temp=null;break}temp=rows[j].cells[i].innerHTML;rows[j].cells[i].innerHTML=newCell;newCell=temp}if(temp==null)break}}else for(j=min;j<this.MAX_MRUL+min;j++){temp=rows[j].cells[0].innerHTML;rows[j].cells[0].innerHTML=newCell;newCell=temp}},NextPage:function(evt){this.cur_page++;return this.UpdatePage(evt)},PrevPage:function(evt){this.cur_page--;return this.UpdatePage(evt)},ResetPage:function(page){if(page&&page>0)this.cur_page=page;else this.cur_page=0;this.UpdatePage()},TotalPages:function(){return Math.round(this.elemTable.clientWidth/this.elemPopup.clientWidth)},UpdatePage:function(evt){var total=this.TotalPages();if(this.cur_page+1>=total){this.cur_page=total-1;this.ChangeObjectDisplay(this.next_btn_id,"none");this.ChangeObjectDisplay(this.prev_btn_id,"block")}else if(this.cur_page<=0){this.cur_page=0;this.ChangeObjectDisplay(this.prev_btn_id,"none");this.ChangeObjectDisplay(this.next_btn_id,"block")}else{this.ChangeObjectDisplay(this.prev_btn_id,"block");this.ChangeObjectDisplay(this.next_btn_id,"block")}var offset=this.elemPopup.clientWidth;if(this.IsRtl)this.elemTable.style.right=-(this.cur_page*offset)+"px";else this.elemTable.style.left=-(this.cur_page*offset)+"px";if(!evt)evt=window.event;if(evt.preventDefault)evt.preventDefault();else evt.returnValue=false;evt.cancelBubble=true;return true}};var FAQ=new CFAQ;function CFAQ(){return this}CFAQ.prototype.Toggle=function(strFAQ){var elemFAQq=document.getElementById(strFAQ+"q"),elemFAQs=document.getElementById(strFAQ+"s"),elemFAQa=document.getElementById(strFAQ+"a");if(elemFAQq==null||elemFAQq=="undefined")return;if(elemFAQs==null||elemFAQs=="undefined")return;if(elemFAQa==null||elemFAQa=="undefined")return;if(elemFAQa.style.display==""||elemFAQa.style.display=="none"){elemFAQs.innerHTML="-";elemFAQa.style.display="block";location.href="#"+elemFAQq.id}else{elemFAQs.innerHTML="+";elemFAQa.style.display="none"}};CFAQ.prototype.Init=function(){if(document.location.hash.length>1){var strAddress=escape(document.location.hash.substring(1)),addressLength=strAddress.length;if(addressLength>=2){if(strAddress.substring(addressLength-1,1).toLowerCase()=="q")strAddress=strAddress.substring(0,addressLength-1);this.Toggle(strAddress)}}};var LangPair=new CLangPair;function CLangPair(){return this}CLangPair.prototype.Init=function(){this.strFromLang="";this.strToLang="";this.strFromLangDesc="";this.strToLangDesc="";this.strLangPair="";this.strFromLangADL="";this.OnChangeHandlerMethod=null;if(LangPair_FromDDL_keys){LangPair_FromDDL=new MtPopUpList;LangPair_FromDDL.Init("LangPair_FromDDL",LangPair_FromDDL_keys,LangPair_FromDDL_values,LangPair_FromDDL_callback,LangPair_FromDDL_popupid)}if(LangPair_ToDDL_keys){LangPair_ToDDL=new MtPopUpList;LangPair_ToDDL.Init("LangPair_ToDDL",LangPair_ToDDL_keys,LangPair_ToDDL_values,LangPair_ToDDL_callback,LangPair_ToDDL_popupid)}this.elemSwapImg=document.getElementById("LangPair_SwapImg");this.elemFromLangLAD=document.getElementById("LangPair_FromLangLAD");this.IsRtl=this.elemSwapImg.dir=="rtl";this.ArrowDirIsReversed=false;var fromParam=Util.GetUrlParameter(window.location.href,"from");if(fromParam==null&&window.location.search&&window.location.search.toLowerCase().indexOf("from=")>-1)fromParam="";if((fromParam||fromParam=="")&&!(this.elemFromLangLAD.value&&fromParam==""))for(var i=0;i<LangPair_FromDDL_keys.length;i++)if(fromParam==LangPair_FromDDL_keys[i]){LangPair_FromDDL.setValue(fromParam,"true");break}var toParam=Util.GetUrlParameter(window.location.href,"to")||Util.GetCookie("to");if(toParam)for(var i=0;i<LangPair_ToDDL_keys.length;i++)if(toParam==LangPair_ToDDL_keys[i]){LangPair_ToDDL.setValue(toParam,"true");break}this.Sync()};CLangPair.prototype.Change=function(that){if(LangPair_FromDDL.getValue()==LangPair_ToDDL.getValue()&&this.strFromLang!=this.strToLang&&this.strFromLang!="")if(that.getValue()==this.strFromLang)LangPair_FromDDL.setValue(this.strToLang);else if(that.getValue()==this.strToLang)LangPair_ToDDL.setValue(this.strFromLang);this.Sync()};CLangPair.prototype.OnChange=function(){if(this.OnChangeHandlerMethod!=null)this.OnChangeHandlerMethod()};CLangPair.prototype.setToLang=function(strToLang){if(LangPair_ToDDL){LangPair_ToDDL.setValue(strToLang);this.Sync()}};CLangPair.prototype.setFromLang=function(strFromLang){if(LangPair_FromDDL){LangPair_FromDDL.setValue(strFromLang);this.Sync()}};CLangPair.prototype.ChangeCallbackHandler=function(method){this.OnChangeHandlerMethod=method};CLangPair.prototype.Sync=function(){if(LangPair_ToDDL!=null&&LangPair_FromDDL!=null){this.strFromLang=LangPair_FromDDL.getValue();LangPair_FromDDL.setValue(this.strFromLang,"true");this.mrulFromLangs=LangPair_FromDDL.MRUL;this.strToLang=LangPair_ToDDL.getValue();LangPair_ToDDL.setValue(this.strToLang,"true");this.mrulToLangs=LangPair_ToDDL.MRUL;this.strLangPair=this.strFromLang+"_"+this.strToLang;this.strFromLangDesc=LangPair_FromDDL.getText();this.strToLangDesc=LangPair_ToDDL.getText();this.strFromLangADL=this.elemFromLangLAD.value;this.OnChange()}};CLangPair.prototype.SetAutoDetectLanguage=function(name,value){this.strFromLangADL=this.elemFromLangLAD.value=value;LangPair_FromDDL.setText(name,"true")};CLangPair.prototype.SwapLang=function(){var from,to,lad;from=LangPair_FromDDL.getValue();to=LangPair_ToDDL.getValue();lad=this.elemFromLangLAD.value;if(from=="")from=lad;if(from!=null&&from!=""&&from!=to){LangPair_ToDDL.setValue(from);LangPair_FromDDL.setValue(to)}this.Sync()};CLangPair.prototype.SwapImg=function(horizontal){if(this.ArrowDirIsReversed)if(horizontal)this.elemSwapImg.src=window.staticContentFolder+"/img/swapLTR.gif";else if(this.IsRtl)this.elemSwapImg.src=window.staticContentFolder+"/img/swapToVertRTL.gif";else this.elemSwapImg.src=window.staticContentFolder+"/img/swapToVertLTR.gif";else if(horizontal)this.elemSwapImg.src=window.staticContentFolder+"/img/swapRTL.gif";else if(this.IsRtl)this.elemSwapImg.src=window.staticContentFolder+"/img/swapFromVertRTL.gif";else this.elemSwapImg.src=window.staticContentFolder+"/img/swapFromVertLTR.gif";this.ArrowDirIsReversed=!this.ArrowDirIsReversed};var LangPairPrev=new CLangPairPrev;function CLangPairPrev(){return this}CLangPairPrev.prototype.Init=function(){this.strFromLang="";this.strToLang="";this.strFromLangDesc="";this.strToLangDesc="";this.strLangPair="";this.strFromLangADL="";this.OnChangeHandlerMethod=null;if(LangPair_FromDDL_keys){LangPair_FromDDL=new MtPopUpListPrev;LangPair_FromDDL.Init("LangPair_FromDDL",LangPair_FromDDL_keys,LangPair_FromDDL_values,LangPair_FromDDL_callback,LangPair_FromDDL_popupid)}if(LangPair_ToDDL_keys){LangPair_ToDDL=new MtPopUpListPrev;LangPair_ToDDL.Init("LangPair_ToDDL",LangPair_ToDDL_keys,LangPair_ToDDL_values,LangPair_ToDDL_callback,LangPair_ToDDL_popupid)}this.elemSwapImg=document.getElementById("LangPair_SwapImg");this.elemFromLangLAD=document.getElementById("LangPair_FromLangLAD");this.IsRtl=this.elemSwapImg.dir=="rtl";this.ArrowDirIsReversed=false;this.Sync()};CLangPairPrev.prototype.Change=function(that){if(LangPair_FromDDL.getValue()==LangPair_ToDDL.getValue()&&this.strFromLang!=this.strToLang&&this.strFromLang!="")if(that.getValue()==this.strFromLang)LangPair_FromDDL.setValue(this.strToLang);else if(that.getValue()==this.strToLang)LangPair_ToDDL.setValue(this.strFromLang);this.Sync()};CLangPairPrev.prototype.OnChange=function(){if(this.OnChangeHandlerMethod!=null)this.OnChangeHandlerMethod()};CLangPairPrev.prototype.ChangeCallbackHandler=function(method){this.OnChangeHandlerMethod=method};CLangPairPrev.prototype.Sync=function(){if(LangPair_ToDDL!=null&&LangPair_FromDDL!=null){this.strFromLang=LangPair_FromDDL.getValue();LangPair_FromDDL.setValue(this.strFromLang,"true");this.strToLang=LangPair_ToDDL.getValue();LangPair_ToDDL.setValue(this.strToLang,"true");this.strLangPair=this.strFromLang+"_"+this.strToLang;this.strFromLangDesc=LangPair_FromDDL.getText();this.strToLangDesc=LangPair_ToDDL.getText();this.strFromLangADL=this.elemFromLangLAD.value;this.OnChange()}};CLangPairPrev.prototype.SetAutoDetectLanguage=function(name,value){this.strFromLangADL=this.elemFromLangLAD.value=value;LangPair_FromDDL.setText(name,"true")};CLangPairPrev.prototype.SwapLang=function(){var from,to,lad;from=LangPair_FromDDL.getValue();to=LangPair_ToDDL.getValue();lad=this.elemFromLangLAD.value;if(from=="")from=lad;if(from!=null&&from!=""&&from!=to){LangPair_ToDDL.setValue(from);LangPair_FromDDL.setValue(to)}this.Sync()};CLangPairPrev.prototype.SwapImg=function(horizontal){if(this.ArrowDirIsReversed)if(horizontal)this.elemSwapImg.src=window.staticContentFolder+"/img/swapLTR.gif";else if(this.IsRtl)this.elemSwapImg.src=window.staticContentFolder+"/img/swapToVertRTL.gif";else this.elemSwapImg.src=window.staticContentFolder+"/img/swapToVertLTR.gif";else if(horizontal)this.elemSwapImg.src=window.staticContentFolder+"/img/swapRTL.gif";else if(this.IsRtl)this.elemSwapImg.src=window.staticContentFolder+"/img/swapFromVertRTL.gif";else this.elemSwapImg.src=window.staticContentFolder+"/img/swapFromVertLTR.gif";this.ArrowDirIsReversed=!this.ArrowDirIsReversed};Layout=new CLayout;Layout.Properties={AReport:null,GoLink:null,LblReported:null,UrlInput:null,TgtParent:null,SrcParent:null,TgtFrame:null,SrcFrame:null,DivSrc:null,DivTgt:null,Content:null,SrcMouse:null,TgtMouse:null,Header:null,Footer_BV:null,Footer_Brand:null,Footer_SB:null,Footer_Live:null,Views:["SS","TB","TP","SP"],ViewTypes:{SideBySide:null,TopBottom:null,TargetOnly:null,SourceOnly:null},ActiveView:"",AnimationBlock:null,AnimationDynamic:null,AnimationStatic:null,AnimationRunning:false,GetDefaultView:function(){return this.Views[2]},GetUrlValue:function(){if(this.UrlInput!=null)return this.UrlInput.value;else return ""}};Layout.Methods={Init:function(url,view){with(Layout.Properties){GoLink=document.getElementById("aExit");AReport=document.getElementById("aReport");LblReported=document.getElementById("lblReported");UrlInput=document.getElementById("inpUrl");Content=document.getElementById("divContent");TgtParent=document.getElementById("divTgtFrm");SrcParent=document.getElementById("divSrcFrm");DivSrc=document.getElementById("divSrc");DivTgt=document.getElementById("divTgt");SrcMouse=document.getElementById("lblSrcMouse");TgtMouse=document.getElementById("lblTgtMouse");Header=document.getElementById("divBVHeader");Footer_BV=document.getElementById("divBVFooter");Footer_Brand=document.getElementById("uxp_ftr_control");Footer_SB=document.getElementById("sb_foot");Footer_Live=document.getElementById("WindowsLiveFooter");AnimationBlock=document.getElementById("spnAnim");AnimationDynamic=document.getElementById("spnTgtLangDynamic");AnimationStatic=document.getElementById("spnTgtLangStatic");AnimationRunning=false;ViewTypes.SideBySide=Views[0];ViewTypes.TopBottom=Views[1];ViewTypes.TargetOnly=Views[2];ViewTypes.SourceOnly=Views[3];if(!Footer_Brand)Footer_Brand=Footer_SB!=null?Footer_SB:Footer_Live;GoLink.className="";if(url&&url.length>0){GoLink.href=UrlInput.value=url;if(AReport)AReport.href="javascript:BV.ReportPage();"}else GoLink.className="Invisible";UrlInput.focus()}this.SetView(view)},SetView:function(view){with(Layout.Properties){var isvalid=false;if(view!=null){ActiveView=view.toUpperCase();for(var i in Views)if(Views[i]==ActiveView){isvalid=true;break}}if(!isvalid)ActiveView=GetDefaultView();switch(ActiveView){case ViewTypes.SideBySide:DivSrc.className="divSrcSS";DivTgt.className="divTgtSS";SrcMouse.className=TgtMouse.className="Invisible";this.SetSideBySideWidths();if(BV.setTooltips)BV.setTooltips(false);break;case ViewTypes.TopBottom:DivSrc.className="divSrcTB";DivTgt.className="divTgtTB";SrcMouse.className=TgtMouse.className="Invisible";if(BV.setTooltips)BV.setTooltips(false);break;case ViewTypes.SourceOnly:DivSrc.className="divXP";DivTgt.className="Invisible";SrcMouse.className="";TgtMouse.className="Invisible";if(BV.setTooltips)BV.setTooltips(true);break;default:DivSrc.className="Invisible";DivTgt.className="divXP";SrcMouse.className="Invisible";TgtMouse.className="";if(BV.setTooltips)BV.setTooltips(true);break}}Layout.Sync()},SetHeight:function(h){with(Layout.Properties){var isTB=ActiveView==ViewTypes.TopBottom,h1=isTB?h/2-4:h-4,h2=h1%2!=0?isTB?h1-1:h1:h1;Content.style.height=h+"px";TgtParent.style.height=h1+"px";SrcParent.style.height=h2+"px";if(SrcFrame!=null)SrcFrame.style.height=h1-1+"px";if(TgtFrame!=null)TgtFrame.style.height=h2-1+"px"}},SetSourceTarget:function(src,tgt){Layout.Properties.SrcFrame=src;Layout.Properties.TgtFrame=tgt;Layout.Sync()},BeginAnimation:function(){this.SetAnimationState(false,true);this.RunAnimation()},EndAnimation:function(hide){this.SetAnimationState(true,false,hide)},ShowAnimationPercent:function(n){this.SetAnimationState(false,false);Layout.Properties.AnimationBlock.innerHTML="&nbsp;"+(n>100?99:n)+"%"},AnimTimeout:null,RunAnimation:function(){if(Layout.Properties.AnimationRunning)with(Layout.Properties){AnimationBlock.innerHTML+=".";if(AnimationBlock.innerHTML.length>6)AnimationBlock.innerHTML=""}this.AnimTimeout=setTimeout(Layout.Methods.RunAnimation,500)},SetAnimationState:function(isStatic,run,hide){with(Layout.Properties){AnimationRunning=run;if(!run&&this.AnimTimeout!=null)clearTimeout(this.AnimTimeout);if(hide){AnimationDynamic.className="Invisible";AnimationStatic.className="Invisible"}else if(isStatic){AnimationDynamic.className="Invisible";AnimationStatic.className="Visible"}else{AnimationStatic.className="Invisible";AnimationDynamic.className="Visible"}}},SetSideBySideWidths:function(){if(Layout.Properties.SrcFrame==null||Layout.Properties.TgtFrame==null)return;if(Layout.Properties.ActiveView!=Layout.Properties.ViewTypes.SideBySide)return;var cw=Layout.Properties.Content.clientWidth;if(cw%2!=0)cw--;Layout.Properties.Content.width=cw;Layout.Properties.SrcFrame.width=cw/2;Layout.Properties.TgtFrame.width=cw/2},HideBVReport:function(){Layout.Properties.AReport.style.display="none"},ShowBVThanksReporting:function(){Layout.Properties.LblReported.style.display="inline"}};function CLayout(){return this}CLayout.prototype.Init=function(){Layout.Methods.Init(Util.GetDocumentUrl(document),Util.GetUrlParameter(location.href,"lo")||Util.GetCookie("lo"));Layout.Methods.SetView(Layout.Properties.ActiveView);this.Sync()};CLayout.prototype.Sync=function(){var sbFooterHeight=0,minHeight=150;with(Layout.Properties){if(Footer_SB!=null)sbFooterHeight=Footer_SB.offsetHeight;var iHeaderFooterHeight=+Header.offsetHeight+Footer_BV.offsetHeight+sbFooterHeight+10;if(document.documentElement.clientHeight<=iHeaderFooterHeight)return;var iHeight=document.documentElement.clientHeight-iHeaderFooterHeight;if(iHeight<minHeight)iHeight=minHeight;for(var i=0;i<Views.length;i++)document.getElementById(Views[i]).className=Views[i]+"_gif";document.getElementById(ActiveView).className=ActiveView+"on_gif"}Layout.Methods.SetHeight(iHeight);Layout.Methods.SetSideBySideWidths()};PlayerState={NoPlayer:0,Stopped:1,Paused:2,Playing:3,Ended:4,Error:5,Unknown:6};WmpState={MpStopped:1,MpPaused:2,MpPlaying:3,MpEnded:8};MediaType={NA:0,WMP:1,QT:2};var PlayTimerId=null;function IsStopped(){var time=document.getElementById(Media.ID).GetTime(),rate=document.getElementById(Media.ID).GetRate(),duration=document.getElementById(Media.ID).GetDuration(),status=document.getElementById(Media.ID).GetPluginStatus().toLowerCase;window.status=time;if(status=="error"){if(Media.OnError!=null)Media.OnError();return}if(rate==0)if(time==duration){if(Media.OnStop!=null)Media.OnStop();return}else{if(Media.OnPaused!=null)Media.OnPaused();return}else StartWatchTimer(500)}function StartWatchTimer(timeDelay){if(PlayTimerId!=null)clearTimeout(PlayTimerId);PlayTimerId=window.setTimeout("IsStopped()",timeDelay)}MediaPlayer=function(){this.PlayerObject=null;this.OnStopEvent=null;this.OnPlayEvent=null;this.OnPauseEvent=null;this.OnErrorEvent=null;this.Pause=null;this.DoPlay=null;this.Stop=null;this.Height=100;this.Width=100;this.AutoPlay=true;this.Create=null;this.HandleEvents=null;this.Play=function(){};this.Stop=function(){};this.Pause=function(){}};Media={PreferredType:null,PlayerType:null,SupportsQT:false,SupportsWMP:false,Enabled:false,URL:"",HtmlParent:null,ID:"mediaplayer",Initalized:false,OnPlay:null,OnStop:null,OnPaused:null,OnError:null,Player:null,PlayerCreated:false,Play:function(url){var urlIsNew=Media.URL!=url;Media.URL=url;if(!Media.Player)if(Media.PlayerType==MediaType.WMP)Media.MakeWMPPlayer();else Media.MakeQTPlayer();if(Media.PlayerType==MediaType.WMP){if(!Media.PlayerCreated){Media.Player.Create();Media.PlayerCreated=true}if(urlIsNew)Media.Player.SetUrl(url);Media.Player.DoPlay()}else Media.Player.SetUrl(url)},Pause:function(){Media.Player.Pause()},Stop:function(){if(Media.Player)Media.Player.Stop()},MakeWMPPlayer:function(){document.mediaPlayerType=MediaType.WMP;Media.Player=new MediaPlayer;with(Media){Player.Create=function(url,parent){Player.PlayerObject=document.createElement("object");Player.PlayerObject.id=Media.ID;Player.PlayerObject.classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6";Player.PlayerObject.autoStart=true;Player.PlayerObject.width=1;Player.PlayerObject.height=1;if(Player.PlayerObject.uiMode)Player.PlayerObject.uiMode="none";Player.PlayerObject.URL=url;HtmlParent.appendChild(Player.PlayerObject);Player.PlayerObject.attachEvent("playStateChange",function(playState){if(playState==WmpState.MpStopped)if(Media.OnStop!=null)Media.OnStop()})};Player.SetUrl=function(url){this.PlayerObject.URL=url};Player.DoPlay=function(){this.PlayerObject.controls.Play();if(Media.OnPlay!=null)Media.OnPlay()};Player.Stop=function(){if(this.PlayerObject){this.PlayerObject.controls.Stop();if(Media.OnStop!=null)Media.OnStop()}};Player.Pause=function(){this.PlayerObject.controls.Pause();if(Media.OnPaused!=null)Media.OnPaused()}}},MakeQTPlayer:function(){document.mediaPlayerType=MediaType.QT;Media.Player=new MediaPlayer;with(Media){Player.Create=function(url,parent){};Player.SetUrl=function(url){var oldChild=document.getElementById(Media.ID),newChild=document.createElement("embed");newChild.setAttribute("PLUGINSPAGE","http://www.apple.com/quicktime/download/");newChild.setAttribute("EnableJavaScript","true");newChild.setAttribute("CONTROLLER","True");newChild.setAttribute("autostart","true");newChild.setAttribute("width","100");newChild.setAttribute("height","100");newChild.setAttribute("id",Media.ID);newChild.setAttribute("hidden","false");newChild.setAttribute("style","position:absolute;z-index:99;top:-300;left:-300;visibility:hidden;");newChild.setAttribute("src",Media.URL);if(oldChild!=null)Media.HtmlParent.replaceChild(newChild,oldChild);else Media.HtmlParent.appendChild(newChild)};Player.DoPlay=function(){};Player.Stop=function(){};Player.Pause=function(){}}},GetPlayerType:function(){if(Media.SupportsQT==false&&Media.SupportsWMP==false)return MediaType.NA;if(Media.PreferredType==MediaType.WMP&&Media.SupportsWMP)return MediaType.WMP;else if(Media.PreferredType==MediaType.QT&&Media.SupportsQT)return MediaType.QT;else if(Media.SupportsWMP)return MediaType.WMP;else return MediaType.QT},Init:function(){if(Media.Initalized)return;Media.Enabled=true;Media.SupportsWMP=MediaUtils.supportsWMP();Media.SupportsQT=MediaUtils.supportsQT();Media.Enabled=Media.SupportsWMP||Media.SupportsQT;Media.PlayerType=Media.GetPlayerType();Media.Initalized=true}};MediaUtils={Initialized:false,dvb:false,canDetect:function(){this.dvb=this.initVB();if(this.dvb||navigator.plugins&&navigator.plugins.length>0)return true;else return false},supportsWMP:function(){if(this.canDetect()){var b=this.detect("Windows Media");if(!b&&this.dvb)b=detectAX("wmplayer.ocx");return b}else return false},supportsQT:function(){if(this.canDetect()){var b=this.detect("QuickTime");if(!b&&this.dvb)b=detectQtAx();return b}else return false},detect:function(){var daPlugins=arguments,foundit=false;if(navigator.plugins&&navigator.plugins.length>0){var pluginsArrayLength=navigator.plugins.length;for(pluginsArrayCounter=0;pluginsArrayCounter<pluginsArrayLength;pluginsArrayCounter++){var numFound=0;for(namesCounter=0;namesCounter<daPlugins.length;namesCounter++)if(navigator.plugins[pluginsArrayCounter].name.indexOf(daPlugins[namesCounter])>=0||navigator.plugins[pluginsArrayCounter].description.indexOf(daPlugins[namesCounter])>=0)numFound++;if(numFound==daPlugins.length){foundit=true;break}}}return foundit},initVB:function(){if(navigator.userAgent.indexOf("MSIE")!=-1&&navigator.userAgent.indexOf("Win")!=-1){if(this.Initialized==false){this.Initialized=true;document.writeln('<script language="VBscript">');document.writeln("dvb = False");document.writeln("If ScriptEngineMajorVersion >= 2 then");document.writeln("  dvb = True");document.writeln("End If");document.writeln("Function detectAX(axName)");document.writeln("  on error resume next");document.writeln("  detectAX = False");document.writeln("  If dvb Then");document.writeln("     detectAX = IsObject(CreateObject(axName))");document.writeln("  End If");document.writeln("End Function");document.writeln("Function detectQtAx()");document.writeln("  on error resume next");document.writeln("  detectQtAx = False");document.writeln("  If dvb Then");document.writeln("    detectQtAx = False");document.writeln("    hasQTChkr = false");document.writeln('    Set hasQTChkr = CreateObject("QuickTime.QuickTime")');document.writeln("    If IsObject(hasQTChkr) Then");document.writeln("      If hasQTChkr.IsQuickTimeAvailable(0) Then ");document.writeln("        detectQtAx = True");document.writeln("      End If");document.writeln("    End If");document.writeln("  End If");document.writeln("End Function");document.writeln("</scr"+"ipt>")}return true}return false}};T2S={AppId:null,Enabled:null,Proxy:null,ProxyCall:null,MaxLength:null,ToLanguage:null,AudioUrl:"",Player:false,QTPlayerId:"qtsound",Init:function(appid,enabled,maxlen,proxy){this.AppId=appid;this.MaxLength=maxlen;this.Proxy=proxy;this.Enabled=enabled},GetBaseParams:function(isWav){if(isWav)return "/Speak?"+"language="+this.ToLanguage+"&appid="+this.AppId+"&text=";else return "/Speak?"+"language="+this.ToLanguage+"&format=audio/mp3"+"&options=MaxQuality"+"&appid="+this.AppId+"&text="},PlayQTSound:function(playlist){var playIndex=0,parent=document.getElementById("mediaPlayerHolder"),oldChild=document.getElementById(this.QTPlayerId);if(playlist.length==0){if(oldChild!=null)parent.removeChild(oldChild);return}var newChild=document.createElement("embed");newChild.setAttribute("autostart","true");newChild.setAttribute("width","0");newChild.setAttribute("height","0");newChild.setAttribute("id",this.QTPlayerId);newChild.setAttribute("hidden","true");newChild.setAttribute("style","position:absolute;z-index:99;top:-300;left:-300;visibility:hidden;");newChild.setAttribute("src",this.GetUrl(playlist[playIndex++]));newChild.setAttribute("postdomevents","true");if(oldChild!=null)parent.replaceChild(newChild,oldChild);else parent.appendChild(newChild);var me=this;Util.AddEvent(newChild,"qt_ended",function(event){newChild.setAttribute("src",me.GetUrl(playlist[playIndex++]))})},PlayIESound:function(url){document.getElementById("iesound").src=url},PlayHTML5Sound:function(playlist){try{var playIndex=0;if(!this.Player)this.Player=new Audio;var player=this.Player;if(playlist.length==0){player.pause();player.src="";return true}var me=this;if(player.canPlayType("audio/mp3")){player.src=this.GetUrl(playlist[playIndex++]);Util.AddEvent(this.Player,"ended",function(event){if(playIndex<playlist.length){player.src=me.GetUrl(playlist[playIndex++]);player.play()}})}else if(player.canPlayType("audio/wav")){player.src=this.GetUrl(playlist[playIndex++],true);Util.AddEvent(this.Player,"ended",function(event){if(playIndex<playlist.length){player.src=me.GetUrl(playlist[playIndex++],true);player.play()}})}else return false;player.play()}catch(ex){return false}return true},Get_TextTags:function(){var tags=[],aSpans=Default.OutputElement.getInput().getElementsByTagName("font");for(var j=0;j<aSpans.length;++j)if(aSpans[j].getAttribute("lang"))tags.push(aSpans[j]);return tags},Play:function(){this.SetNewTranslation();var tags=this.Get_TextTags(),txts=[],temp="";for(var i=0;i<tags.length;i++){temp=tags[i].innerText||tags[i].textContent||"";temp=temp.replace(/\s+/g," ").trim();if(temp)txts.push(temp)}this.PlayText(txts)},PlayText:function(textList){if(textList&&textList.length>0){textList.push("");var playlist=[],tempStr="",tempInt=0,text="";for(var i=0;i<textList.length;i++){text=(text+" "+textList[i]).trim();while(text.length>this.MaxLength){tempStr=text.substr(0,this.MaxLength);if((tempInt=tempStr.lastIndexOf("."))>0)tempStr=tempStr.substr(0,tempInt);else if((tempInt=tempStr.lastIndexOf(" "))>0)tempStr=tempStr.substr(0,tempInt);else tempInt=this.MaxLength;text=text.slice(tempInt+1).trim();playlist.push(encodeURIComponent(tempStr).replace(/%20/g,"+").trim("+"))}if(textList[i].length>0){tempStr=(text+" "+textList[i+1]).trim();if(tempStr.length>this.MaxLength){playlist.push(encodeURIComponent(text).replace(/%20/g,"+").trim("+"));text=""}}else if(text.length>0){playlist.push(encodeURIComponent(text).replace(/%20/g,"+").trim("+"));text=""}}if(!this.PlayHTML5Sound(playlist)){var url=this.GetUrl(playlist[0]);if(navigator.appVersion.indexOf("MSIE")>=0)this.PlayIESound(url);else this.PlayQTSound(playlist)}}},GetUrl:function(txt,isWav){return this.Proxy+this.GetBaseParams(isWav)+txt},SetPreTrans:function(){this.Translating=true},SetNewTranslation:function(){this.ToLanguage=Default.Language.getTo();if(navigator.appVersion.indexOf("MSIE")>=0)document.getElementById("iesound").src="about:blank";this.PlayHTML5Sound("");this.PlayQTSound("")}};Text2Speech={NameSpace:null,SrcText:null,ToLang:null,Proxy:null,AppId:null,ClientId:"_mtsnd",Stop:function(){var dummy="nosnd.wav",e=document.getElementById(this.NameSpace+this.ClientId);if(e!=null)e.src=dummy},Play:function(senderId){try{var Params="text="+this.SrcText+"&language="+this.ToLang+"&format=audio/mp3"+"&options=MaxQuality"+"&appid="+this.AppId,ProxyCall=this.Proxy+"/Speak?"+Params;if(senderId!=null&&document.getElementById(senderId)!=null)document.getElementById(senderId).blur();if(Params.length>1600)return;if(!Util.MSIE){var oldChild=document.getElementById(this.NameSpace+this.ClientId),parent=oldChild.parentNode,newChild=document.createElement("embed");newChild.setAttribute("autostart","true");newChild.setAttribute("width","100");newChild.setAttribute("height","100");newChild.setAttribute("id",this.NameSpace+this.ClientId);newChild.setAttribute("hidden","false");newChild.setAttribute("style","position:absolute;z-index:99;top:-300;left:-300;visibility:hidden;");newChild.setAttribute("src",ProxyCall);parent.replaceChild(newChild,oldChild)}else document.getElementById(this.NameSpace+this.ClientId).src=ProxyCall}catch(e){alert(e.description)}},AddEvent:function(elem,sEvent,fn){if(elem.addEventListener)elem.addEventListener(sEvent,fn,false);else if(elem.attachEvent)elem.attachEvent("on"+sEvent,fn)}};Tools=new CTools;function CTools(){return this}CTools.prototype.Init=function(){};function CUtil(){var agent=navigator.userAgent.toLowerCase();this.MSIE=agent.indexOf("msie")!=-1&&agent.indexOf("opera")==-1;this.MSIE6=this.MSIE&&agent.indexOf("msie 6.")!=-1;this.MSIE7=this.MSIE&&agent.indexOf("msie 7.")!=-1;this.FIREFOX=agent.indexOf("firefox")!=-1;this.SAFARI=agent.indexOf("applewebkit")!=-1;this.GetPath=function(){var cPath="/";if(location.pathname){cPath=location.pathname.match(/\/\w*/i);if(cPath)cPath=cPath[0]}return cPath};this.AddFavorites=function(){var strTitle=document.title,strUrl=window.location.href;if(this.FIREFOX)window.sidebar.addPanel(strTitle,strUrl,"");else window.external.AddFavorite(strUrl,strTitle)};this.SetCookie=function(strCookieName,strCookieValue,bPersist,strPath){if(!strPath)strPath="/";document.cookie=strCookieName+"="+strCookieValue+(bPersist?"; expires=Sun, 01-Jan-2040 01:01:01 GMT":"")+"; path="+strPath};this.GetCookie=function(strCookieName){var rgxCookieValue=eval("document.cookie.match(/"+strCookieName+"s*=([^;]*)(;|$)/);");if(rgxCookieValue!=null)return rgxCookieValue[1];else{rgxCookieValue=eval("document.cookie.match(/"+strCookieName+"s*([^;]*)(;|$)/);");if(rgxCookieValue!=null)return rgxCookieValue[1];else return null}};this.AddEvent=function(elem,strEvent,fnctPtr){if(elem.addEventListener)elem.addEventListener(strEvent,fnctPtr,false);else if(elem.attachEvent)elem.attachEvent("on"+strEvent,fnctPtr)};this.AbsXPos=function(elem){return elem.offsetLeft+(elem.offsetParent!=null?this.AbsXPos(elem.offsetParent):0)};this.AbsYPos=function(elem){return elem.offsetTop+(elem.offsetParent!=null?this.AbsYPos(elem.offsetParent):0)};this.SetDDLByVal=function(value,elemDDL){for(var i=0;i<elemDDL.options.length;i++)if(elemDDL.options[i].value==value){elemDDL.options[i].selected=true;return}};this.GetElement=function(id){if(arguments.length<=0)return null;if(document.getElementById)return document.getElementById(id);else if(document.all)return document.all(id);else if(document.layers)return window.document.layers[id];else return null};this.GetStyleObject=function(objectId){if(document.getElementById&&document.getElementById(objectId))return document.getElementById(objectId).style;else if(document.all&&document.all(objectId))return document.all(objectId).style;else if(document.layers&&document.layers[objectId])return document.layers[objectId];else return false};this.GetStyleValue=function(objectId,styleProp){var x=document.getElementById(objectId)||document.body,y;if(x.currentStyle)y=x.currentStyle[styleProp]||x.currentStyle.getAttribute(styleProp.replace("-"));else if(window.getComputedStyle)y=document.defaultView.getComputedStyle(x,null).getPropertyValue(styleProp);return y};this.GetScrollBounds=function(documentObject){if(documentObject==null)return {x:0,y:0,width:0,height:0};var x,y,width,height;if(documentObject.documentElement!=null&&documentObject.documentElement.scrollTop!=null&&documentObject.documentElement.scrollTop>=documentObject.body.scrollTop){x=documentObject.documentElement.scrollLeft;y=documentObject.documentElement.scrollTop;width=documentObject.documentElement.scrollWidth;height=documentObject.documentElement.scrollHeight}else{x=documentObject.body.scrollLeft;y=documentObject.body.scrollTop;width=documentObject.body.scrollWidth;height=documentObject.body.scrollHeight}return {x:x,y:y,width:width,height:height}};this.GetUrlParameter=function(InUrl,InParamName){InParamName=InParamName.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var Pattern="[\\?&]"+InParamName+"=([^&#]*)",Regex=new RegExp(Pattern,"i"),Results=Regex.exec(InUrl);if(Results==null)return null;else return Results[1]};this.GetDocumentUrl=function(document){var url="";if(document.location.hash.length>1)url=document.location.hash.substring(1);else if(document.location.search.indexOf("a=")>0)url=decodeURIComponent(document.location.search.substring(document.location.search.indexOf("a=")+2));while(url&&url.toLowerCase().indexOf("/bv.aspx")>=0&&url.toLowerCase().indexOf("a=")>=0)url=decodeURIComponent(url.substring(url.toLowerCase().indexOf("a=")+2));if(url.length>0){url=url.replace(/^\s*/,"").replace(/\s*$/,"");if(url.indexOf("?")==-1)url=url.replace("&","?")}if(url&&url.indexOf("://")==-1)url="http://"+url;if(url&&url.toLowerCase().indexOf("/bv.aspx")>=0)url="";return url};this.SendPostRequest=function(url,params,target){var form=document.createElement("form");form.action=url;form.method="post";form.target=target;for(var key in params)if(params.hasOwnProperty(key)){var input=document.createElement("input");input.name=key;input.value=params[key];input.type="hidden";form.appendChild(input)}document.body.appendChild(form);form.submit();document.body.removeChild(form)};this.Log=function(source,params){Microsoft.Translator.LoadScript("/sync.ashx?svc="+source+"&"+params.join("&"))};this.GetCaretPosition=function(input){if("selectionStart" in input&&document.activeElement==input)return {start:input.selectionStart,end:input.selectionEnd};else if(input.createTextRange){var sel=document.selection.createRange();if(sel.parentElement()===input){var rng=input.createTextRange();rng.moveToBookmark(sel.getBookmark());for(var len=0;rng.compareEndPoints("EndToStart",rng)>0;rng.moveEnd("character",-1))len++;rng.setEndPoint("StartToStart",input.createTextRange());for(var pos={start:0,end:len};rng.compareEndPoints("EndToStart",rng)>0;rng.moveEnd("character",-1)){pos.start++;pos.end++}return pos}}return -1};this.SetSelectionRange=function(input,selectionStart,selectionEnd){if(input.setSelectionRange){input.focus();input.setSelectionRange(selectionStart,selectionEnd)}else if(input.createTextRange){var range=input.createTextRange();range.collapse(true);range.moveEnd("character",selectionEnd);range.moveStart("character",selectionStart);range.select()}};this.SetCaretToPosition=function(input,pos){this.SetSelectionRange(input,pos,pos)};this.addClass=function(obj,className){var classNames=obj.className.split(" ");for(var i=0;i<classNames.length;i++)if(className==classNames[i])return;obj.className+=" "+className};this.removeClass=function(obj,className){var classNames=obj.className.split(" ");obj.className="";for(var i=0;i<classNames.length;i++)if(className!=classNames[i]){obj.className+=classNames[i];if(i==classNames.length-1)obj.className+=" "}};this.getPosition=function(elem){var x=0,y=0;while(elem&&!isNaN(elem.offsetLeft)&&!isNaN(elem.offsetTop)){x+=elem.offsetLeft-elem.scrollLeft;y+=elem.offsetTop-elem.scrollTop;elem=elem.offsetParent}return {top:y,left:x}};return this}var Util=new CUtil